
import React, { useEffect, useState } from "react";
import { View, Text, Dimensions, ScrollView } from "react-native";
import { LineChart } from "react-native-chart-kit";
import axios from "axios";

export default function App() {
  const [data, setData] = useState([]);

  useEffect(() => {
    const fetchData = async () => {
      const res = await axios.get(
        "https://www.alphavantage.co/query?function=FX_INTRADAY&from_symbol=EUR&to_symbol=USD&interval=5min&apikey=demo"
      );
      const t = res.data["Time Series FX (5min)"];
      if (!t) return;
      const prices = Object.keys(t)
        .slice(0, 10)
        .reverse()
        .map((k) => parseFloat(t[k]["4. close"]));
      setData(prices);
    };
    fetchData();
  }, []);

  return (
    <ScrollView>
      <View style={{ padding: 20 }}>
        <Text style={{ fontSize: 20, textAlign: "center", color: "#0f0" }}>
          FTRADER - EUR/USD
        </Text>
        {data.length > 0 ? (
          <LineChart
            data={{ labels: Array(10).fill(""), datasets: [{ data }] }}
            width={Dimensions.get("window").width - 30}
            height={220}
            yAxisLabel="$"
            chartConfig={{
              backgroundGradientFrom: "#000",
              backgroundGradientTo: "#111",
              color: () => "#0f0",
            }}
            style={{ borderRadius: 10 }}
          />
        ) : (
          <Text style={{ textAlign: "center" }}>Cargando datos...</Text>
        )}
      </View>
    </ScrollView>
  );
}
