---
title: Configure multiple app variants
sidebar_title: Multiple app variants
description: Learn how to configure app config to install multiple app variants on a single device.
---

import { Step } from '~/ui/components/Step';
import { Terminal } from '~/ui/components/Snippet';
import ImageSpotlight from '~/components/plugins/ImageSpotlight';
import { BoxLink } from '~/ui/components/BoxLink';
import { BookOpen02Icon } from '@expo/styleguide-icons';

In this chapter, we're going to configure our project to run multiple build types (development, preview, production) so that they can be installed simultaneously on a single device. This setup is useful for testing various stages of our app without the hassle of uninstalling and reinstalling different versions.

Our **app.json** file already has IDs for both Android and iOS:

```json app.json
{
  "ios": {
    /* @info */
    "bundleIdentifier": "com.amanhimself.stickersmash"
    /* @end */
    /* @hide ... */ /* @end */
  },
  "android": {
    /* @info */
    "package": "com.amanhimself.stickersmash"
    /* @end */
    /* @hide ... */ /* @end */
  }
  /* @hide ... */ /* @end */
}
```

Each variant needs a unique Android Application ID and iOS Bundle Identifier to run multiple variants on one device.

> We're also going to use this setup in the next chapter when we learn and create internal distribution builds.

<Step label="1">

## Convert app.json to app.config.js for dynamic configuration

**app.json** contains app-related configuration in a JSON file. It's static and doesn't suit our use case if we want to use dynamic values for certain fields. We're going to add different Android Application IDs and iOS Bundle Identifiers for all build profiles based on environment variables.

Let's modify it:

- In our code editor, rename **app.json** to **app.config.js**.
- In **app.config.js**, add environment variables called `IS_DEV`, which takes `development` as its value and `IS_PREVIEW`, which takes `preview` as its value:

```js app.config.js
const IS_DEV = process.env.APP_VARIANT === 'development';
const IS_PREVIEW = process.env.APP_VARIANT === 'preview';
```

- Add two functions that dynamically change the app name, Android Application ID and iOS Bundle Identifier:

```js app.config.js
const getUniqueIdentifier = () => {
  if (IS_DEV) {
    return 'com.amanhimself.stickersmash.dev';
  }

  if (IS_PREVIEW) {
    return 'com.amanhimself.stickersmash.preview';
  }

  return 'com.amanhimself.stickersmash';
};

const getAppName = () => {
  if (IS_DEV) {
    return 'StickerSmash (Dev)';
  }

  if (IS_PREVIEW) {
    return 'StickerSmash (Preview)';
  }

  return 'StickerSmash: Emoji Stickers';
};
```

- We'll use `getAppName()` to assign varying `name` values for the app and `getUniqueIdentifier()` to differentiate `android.package` and `ios.bundleIdentifier` for development and preview builds:

{/* prettier-ignore */}
```js app.config.js
export default {
  /* @info Using getAppName() for "name" property */
  name: getAppName(),
  /* @end */
  /* @hide ... */ /* @end */
  ios: {
    /* @info Using getUniqueIdentifier() for "bundleIdentifier" property */
    bundleIdentifier: getUniqueIdentifier(),
    /* @end */
    /* @hide ... */ /* @end */
  },
  android: {
    /* @info Using getUniqueIdentifier() for "package" property */
    package: getUniqueIdentifier(),
    /* @end */
    /* @hide ... */ /* @end */
  },
};
```

</Step>

<Step label="2">

## Configure eas.json

In **eas.json**, add the `APP_VARIANT` environment variable:

{/* prettier-ignore */}
```json eas.json
{
  "build": {
    "development": {
      "developmentClient": true,
      "distribution": "internal",
      /* @info Add env.APP_VARIANT property to access the environment variable for the build profile*/
      "env": {
        "APP_VARIANT": "development"
      }
      /* @end */
    },
    "preview": {
      "distribution": "internal",
      /* @info Add env.APP_VARIANT property to access the environment variable for the build profile*/
      "env": {
        "APP_VARIANT": "preview"
      }
      /* @end */
    }
    /* @hide ... */ /* @end */
  }
}
```

Running `eas build --profile development` will now set `APP_VARIANT` to `development`.

> **Note**: Since we changed Android Application ID and iOS Bundle Identifier, the EAS CLI will prompt us to generate a new Keystore for Android and a new provisioning profile for iOS. To learn more about what these steps include, see the previous chapter for more information.

Since our `ios-simulator` build profile extends `development`, this configuration is automatically applied.

</Step>

<Step label="3">

## Run development server

> After builds are complete, follow the same procedure from previous chapters to install them on a device or emulator/simulator.

Since we're identifying our development build with the `APP_VARIANT` environment variable, we need to pass it to the command when starting the development server. To do this, add a `dev` script in the `"scripts"` section of our project's **package.json**:

```json package.json
{
  "scripts": {
    "dev": "APP_VARIANT=development npx expo start"
  }
}
```

Run `npm run dev` command to start the development server:

<Terminal cmd={['$ npm run dev']} />

This script will evaluate **app.config.js** locally and load the environment variable for the `development` profile.

Now, our development build will run on both Android and iOS, displaying the modified app name from **app.config.js**. For example, the below development build is running on an iOS Simulator. See that the app name is **StickerSmash (Dev)**:

<ImageSpotlight
  alt="Development variant running on Android device."
  src="/static/images/tutorial/eas/ios-dev-variant.png"
  style={{ maxWidth: 280 }}
/>

</Step>

## Summary

In this chapter, we

- Set up various build types on a single device.
- Transitioned from static **app.json** to dynamic **app.config.js** for distinct build identifiers and app metadata such as name.
- Added environment variables in **eas.json** for development and preview builds.
- Introduced a script in **package.json** and initiated the development server with `npm run dev`.

We can go beyond and add more development related indicators (such as a different app icon or splash screen), but for brevity, we are not going to do that in this tutorial. However, you should try it out.

## Next step

<BoxLink
  title="Configure multiple app variants"
  Icon={BookOpen02Icon}
  description="In the next chapter, learn about what are internal distribution builds, why we need them, and how to create them."
  href="/tutorial/eas/internal-distribution-builds/"
/>
