name: Validate owners of packages on npm

on:
  workflow_dispatch: {}
  schedule:
    - cron: '0 8 * * *' # 8:00 AM UTC time every day

jobs:
  validate-npm-owners:
    runs-on: ubuntu-24.04
    steps:
      - name: üëÄ Checkout
        uses: actions/checkout@v4
      - name: ‚ûï Add `bin` to GITHUB_PATH
        run: echo "$(pwd)/bin" >> $GITHUB_PATH
      - name: ‚ôªÔ∏è Restore caches
        uses: ./.github/actions/expo-caches
        id: expo-caches
        with:
          yarn-tools: 'true'
      - name: üîé Validate
        run: expotools validate-npm-owners
        env:
          NPM_TOKEN_READ_ONLY: ${{ secrets.NPM_TOKEN_READ_ONLY }}
      - name: üîî Notify on Slack
        uses: ./.github/actions/slack-notify
        if: failure()
        with:
          webhook: ${{ secrets.slack_webhook_api }}
          author_name: Validate npm owners
