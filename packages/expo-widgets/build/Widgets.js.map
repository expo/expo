{"version":3,"file":"Widgets.js","sourceRoot":"","sources":["../src/Widgets.ts"],"names":[],"mappings":"AAEA,OAAO,gBAAgB,MAAM,eAAe,CAAC;AAO7C,OAAO,EAAE,iBAAiB,EAAE,MAAM,aAAa,CAAC;AAChD,OAAO,EAAE,SAAS,EAAE,MAAM,cAAc,CAAC;AAEzC,MAAM,CAAC,MAAM,iBAAiB,GAAG,CAC/B,IAAY,EACZ,YAAmC,EACnC,GAAY,EACZ,EAAE;IACF,MAAM,IAAI,GAAG,SAAS,CAAC,YAAY,EAAE,CAAC,CAAC;IACvC,OAAO,gBAAgB,CAAC,iBAAiB,CAAC,IAAI,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;AAC7D,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,kBAAkB,GAAG,CAChC,EAAU,EACV,IAAY,EACZ,YAAmC,EACnC,EAAE;IACF,MAAM,IAAI,GAAG,SAAS,CAAC,YAAY,EAAE,CAAC,CAAC;IACvC,gBAAgB,CAAC,kBAAkB,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;AACtD,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,oBAAoB,GAAG,CAClC,IAAY,EACZ,KAAa,EACb,MAAgD,EAChD,KAAS,EACT,EAAE;IACF,MAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC,MAAM,CAC/C,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;QACX,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK,GAAG,IAAI,CAAC;QACxB,OAAO,GAAG,CAAC;IACb,CAAC,EACD,EAA4B,CAC7B,CAAC;IAEF,MAAM,IAAI,GAA8C,iBAAiB;SACtE,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;QAChB,MAAM;QACN,OAAO,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YAC5B,SAAS,EAAE,IAAI,CAAC,OAAO,EAAE;YACzB,OAAO,EAAE,MAAM,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,GAAI,SAAe,EAAE,CAAC;SACvD,CAAC,CAAC;KACJ,CAAC,CAAC;SACF,MAAM,CACL,CAAC,GAAG,EAAE,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,EAAE;QAC3B,GAAG,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC;QACtB,OAAO,GAAG,CAAC;IACb,CAAC,EACD,EAA+C,CAChD,CAAC;IAEJ,gBAAgB,CAAC,YAAY,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;IAE5D,gBAAgB,CAAC,YAAY,EAAE,CAAC;AAClC,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,oBAAoB,GAAG,CAClC,IAAY,EACZ,MAAgD,EAChD,KAAS,EACT,EAAE;IACF,oBAAoB,CAAC,IAAI,EAAE,CAAC,IAAI,IAAI,EAAE,CAAC,EAAE,MAAM,EAAE,KAAK,IAAK,EAAQ,CAAC,CAAC;AACvE,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,gBAAgB,GAAwC,gBAAgB,CAAC,WAAW,CAAC","sourcesContent":["import React from 'react';\n\nimport ExpoWidgetModule from './ExpoWidgets';\nimport {\n  ExpoTimelineEntry,\n  LiveActivityComponent,\n  WidgetFamily,\n  WidgetProps,\n} from './Widgets.types';\nimport { supportedFamilies } from './constants';\nimport { serialize } from './serializer';\n\nexport const startLiveActivity = (\n  name: string,\n  liveActivity: LiveActivityComponent,\n  url?: string\n) => {\n  const text = serialize(liveActivity());\n  return ExpoWidgetModule.startLiveActivity(name, text, url);\n};\n\nexport const updateLiveActivity = (\n  id: string,\n  name: string,\n  liveActivity: LiveActivityComponent\n) => {\n  const text = serialize(liveActivity());\n  ExpoWidgetModule.updateLiveActivity(id, name, text);\n};\n\nexport const updateWidgetTimeline = <T extends object>(\n  name: string,\n  dates: Date[],\n  widget: (p: WidgetProps<T>) => React.JSX.Element,\n  props?: T\n) => {\n  const fakeProps = Object.keys(props || {}).reduce(\n    (acc, key) => {\n      acc[key] = `{{${key}}}`;\n      return acc;\n    },\n    {} as Record<string, string>\n  );\n\n  const data: Record<WidgetFamily, ExpoTimelineEntry[]> = supportedFamilies\n    .map((family) => ({\n      family,\n      entries: dates.map((date) => ({\n        timestamp: date.getTime(),\n        content: widget({ date, family, ...(fakeProps as T) }),\n      })),\n    }))\n    .reduce(\n      (acc, { family, entries }) => {\n        acc[family] = entries;\n        return acc;\n      },\n      {} as Record<WidgetFamily, ExpoTimelineEntry[]>\n    );\n\n  ExpoWidgetModule.updateWidget(name, serialize(data), props);\n\n  ExpoWidgetModule.reloadWidget();\n};\n\nexport const updateWidgetSnapshot = <T extends object>(\n  name: string,\n  widget: (p: WidgetProps<T>) => React.JSX.Element,\n  props?: T\n) => {\n  updateWidgetTimeline(name, [new Date()], widget, props || ({} as T));\n};\n\nexport const addEventListener: typeof ExpoWidgetModule.addListener = ExpoWidgetModule.addListener;\n"]}