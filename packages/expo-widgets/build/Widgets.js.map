{"version":3,"file":"Widgets.js","sourceRoot":"","sources":["../src/Widgets.ts"],"names":[],"mappings":"AAGA,OAAO,gBAAgB,MAAM,eAAe,CAAC;AAQ7C,OAAO,EAAE,iBAAiB,EAAE,MAAM,aAAa,CAAC;AAChD,OAAO,EAAE,SAAS,EAAE,MAAM,cAAc,CAAC;AAEzC;;;;;;;;GAQG;AACH,MAAM,CAAC,MAAM,iBAAiB,GAAG,CAC/B,IAAY,EACZ,YAAmC,EACnC,GAAY,EACZ,EAAE;IACF,MAAM,IAAI,GAAG,SAAS,CAAC,YAAY,EAAE,CAAC,CAAC;IACvC,OAAO,gBAAgB,CAAC,iBAAiB,CAAC,IAAI,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;AAC7D,CAAC,CAAC;AAEF;;;;;;GAMG;AACH,MAAM,CAAC,MAAM,kBAAkB,GAAG,CAChC,EAAU,EACV,IAAY,EACZ,YAAmC,EACnC,EAAE;IACF,MAAM,IAAI,GAAG,SAAS,CAAC,YAAY,EAAE,CAAC,CAAC;IACvC,gBAAgB,CAAC,kBAAkB,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;AACtD,CAAC,CAAC;AAEF;;;;;;;;;;GAUG;AACH,MAAM,CAAC,MAAM,oBAAoB,GAAG,CAClC,IAAY,EACZ,KAAa,EACb,MAA+C,EAC/C,KAAS,EACT,cAAuB,EACvB,EAAE;IACF,MAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC,MAAM,CAC/C,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;QACX,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK,GAAG,IAAI,CAAC;QACxB,OAAO,GAAG,CAAC;IACb,CAAC,EACD,EAA4B,CAC7B,CAAC;IAEF,MAAM,IAAI,GAA8C,iBAAiB;SACtE,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;QAChB,MAAM;QACN,OAAO,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YAC5B,SAAS,EAAE,IAAI,CAAC,OAAO,EAAE;YACzB,OAAO,EAAE,MAAM,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,GAAI,SAAe,EAAE,CAAC;SACvD,CAAC,CAAC;KACJ,CAAC,CAAC;SACF,MAAM,CACL,CAAC,GAAG,EAAE,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,EAAE;QAC3B,GAAG,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC;QACtB,OAAO,GAAG,CAAC;IACb,CAAC,EACD,EAA+C,CAChD,CAAC;IAEJ,gBAAgB,CAAC,YAAY,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,cAAc,CAAC,CAAC;IAE5E,gBAAgB,CAAC,YAAY,EAAE,CAAC;AAClC,CAAC,CAAC;AAEF;;;;;;;;;GASG;AACH,MAAM,CAAC,MAAM,oBAAoB,GAAG,CAClC,IAAY,EACZ,MAA+C,EAC/C,KAAS,EACT,cAAuB,CAAC,kCAAkC;EAC1D,EAAE;IACF,oBAAoB,CAAC,IAAI,EAAE,CAAC,IAAI,IAAI,EAAE,CAAC,EAAE,MAAM,EAAE,KAAK,IAAK,EAAQ,EAAE,cAAc,CAAC,CAAC;AACvF,CAAC,CAAC;AAEF;;;;;GAKG;AACH,MAAM,UAAU,0BAA0B,CACxC,QAAgD;IAEhD,OAAO,gBAAgB,CAAC,WAAW,CAAC,mBAAmB,EAAE,QAAQ,CAAC,CAAC;AACrE,CAAC","sourcesContent":["import { type EventSubscription } from 'expo-modules-core';\nimport React from 'react';\n\nimport ExpoWidgetModule from './ExpoWidgets';\nimport {\n  ExpoTimelineEntry,\n  ExpoWidgetsEvents,\n  LiveActivityComponent,\n  WidgetFamily,\n  WidgetBase,\n} from './Widgets.types';\nimport { supportedFamilies } from './constants';\nimport { serialize } from './serializer';\n\n/**\n * Starts a new Live Activity on iOS.\n * Live Activities display real-time information on the Lock Screen and in the Dynamic Island.\n * @param name The name/identifier of the Live Activity to start.\n * @param liveActivity A function that returns the Live Activity layout configuration.\n * @param url An optional deep link URL to open when the user taps the Live Activity.\n * @return The unique identifier of the started Live Activity.\n * @platform ios\n */\nexport const startLiveActivity = (\n  name: string,\n  liveActivity: LiveActivityComponent,\n  url?: string\n) => {\n  const text = serialize(liveActivity());\n  return ExpoWidgetModule.startLiveActivity(name, text, url);\n};\n\n/**\n * Updates an existing Live Activity with new content.\n * @param id The unique identifier of the Live Activity to update (returned from `startLiveActivity`).\n * @param name The name/identifier of the Live Activity.\n * @param liveActivity A function that returns the updated Live Activity layout configuration.\n * @platform ios\n */\nexport const updateLiveActivity = (\n  id: string,\n  name: string,\n  liveActivity: LiveActivityComponent\n) => {\n  const text = serialize(liveActivity());\n  ExpoWidgetModule.updateLiveActivity(id, name, text);\n};\n\n/**\n * Updates a widget's timeline with multiple entries that will be displayed at scheduled times.\n * The widget system will automatically switch between entries based on their timestamps.\n * @param name The name/identifier of the widget to update.\n * @param dates An array of dates representing when each timeline entry should be displayed.\n * @param widget A function component that renders the widget content for a given set of props.\n * @param props Optional custom props to pass to the widget component.\n * @param updateFunction Optional name of a function to call for dynamic updates.\n * @template T The type of custom props passed to the widget.\n * @platform ios\n */\nexport const updateWidgetTimeline = <T extends object>(\n  name: string,\n  dates: Date[],\n  widget: (p: WidgetBase<T>) => React.JSX.Element,\n  props?: T,\n  updateFunction?: string\n) => {\n  const fakeProps = Object.keys(props || {}).reduce(\n    (acc, key) => {\n      acc[key] = `{{${key}}}`;\n      return acc;\n    },\n    {} as Record<string, string>\n  );\n\n  const data: Record<WidgetFamily, ExpoTimelineEntry[]> = supportedFamilies\n    .map((family) => ({\n      family,\n      entries: dates.map((date) => ({\n        timestamp: date.getTime(),\n        content: widget({ date, family, ...(fakeProps as T) }),\n      })),\n    }))\n    .reduce(\n      (acc, { family, entries }) => {\n        acc[family] = entries;\n        return acc;\n      },\n      {} as Record<WidgetFamily, ExpoTimelineEntry[]>\n    );\n\n  ExpoWidgetModule.updateWidget(name, serialize(data), props, updateFunction);\n\n  ExpoWidgetModule.reloadWidget();\n};\n\n/**\n * Updates a widget with a single snapshot entry for the current time.\n * This is a convenience wrapper around `updateWidgetTimeline` for widgets that don't need multiple timeline entries.\n * @param name The name/identifier of the widget to update.\n * @param widget A function component that renders the widget content for a given set of props.\n * @param props Optional custom props to pass to the widget component.\n * @param updateFunction Optional name of a function to call for dynamic updates.\n * @template T The type of custom props passed to the widget.\n * @platform ios\n */\nexport const updateWidgetSnapshot = <T extends object>(\n  name: string,\n  widget: (p: WidgetBase<T>) => React.JSX.Element,\n  props?: T,\n  updateFunction?: string // (target: string, props: T) => T\n) => {\n  updateWidgetTimeline(name, [new Date()], widget, props || ({} as T), updateFunction);\n};\n\n/**\n * Adds a listener for widget interaction events (e.g., button taps).\n * @param listener Callback function to handle user interaction events.\n * @return An event subscription that can be used to remove the listener.\n * @platform ios\n */\nexport function addUserInteractionListener(\n  listener: ExpoWidgetsEvents['onUserInteraction']\n): EventSubscription {\n  return ExpoWidgetModule.addListener('onUserInteraction', listener);\n}\n"]}