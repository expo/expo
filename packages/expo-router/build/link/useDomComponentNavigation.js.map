{"version":3,"file":"useDomComponentNavigation.js","sourceRoot":"","sources":["../../src/link/useDomComponentNavigation.ts"],"names":[],"mappings":";;;;;AA4BA,4CAIC;AAED,wCAEC;AAED,sCAEC;AAED,8CAEC;AAED,4CAEC;AAED,8DAyBC;AA3ED,4CAA4D;AAC5D,kDAA0B;AAG1B,qDAOiC;AAEjC,MAAM,gBAAgB,GAAG,eAAe,CAAC;AACzC,MAAM,uBAAuB,GAAG,qBAAqB,CAAC;AACtD,MAAM,mBAAmB,GAAG,kBAAkB,CAAC;AAC/C,MAAM,gBAAgB,GAAG,iBAAiB,CAAC;AAC3C,MAAM,sBAAsB,GAAG,oBAAoB,CAAC;AAEpD,SAAS,YAAY,CAAC,IAAY,EAAE,OAAY,EAAE;IAChD,oFAAoF;IACpF,IAAI,OAAO,kBAAkB,KAAK,WAAW,EAAE,CAAC;QAC7C,MAAc,CAAC,kBAAkB,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;QAC/E,OAAO,IAAI,CAAC;IACd,CAAC;IACD,OAAO,KAAK,CAAC;AACf,CAAC;AAED,SAAgB,gBAAgB,CAC9B,SAA4E,EAAE;IAE9E,OAAO,YAAY,CAAC,sBAAsB,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC;AAC1D,CAAC;AAED,SAAgB,cAAc,CAAC,KAAc;IAC3C,OAAO,YAAY,CAAC,mBAAmB,EAAE,EAAE,KAAK,EAAE,CAAC,CAAC;AACtD,CAAC;AAED,SAAgB,aAAa;IAC3B,OAAO,YAAY,CAAC,gBAAgB,CAAC,CAAC;AACxC,CAAC;AAED,SAAgB,iBAAiB;IAC/B,OAAO,YAAY,CAAC,uBAAuB,CAAC,CAAC;AAC/C,CAAC;AAED,SAAgB,gBAAgB,CAAC,IAAY,EAAE,OAAsB;IACnE,OAAO,YAAY,CAAC,gBAAgB,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;AAC3D,CAAC;AAED,SAAgB,yBAAyB,CAAC,KAAkB;IAC1D,eAAK,CAAC,SAAS,CAAC,GAAG,EAAE;QACnB,IAAI,OAAO,CAAC,GAAG,CAAC,OAAO,KAAK,KAAK,EAAE,CAAC;YAClC,OAAO,GAAG,EAAE,GAAE,CAAC,CAAC;QAClB,CAAC;QACD,OAAO,IAAA,kCAAyB,EAAM,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE;YACvD,QAAQ,IAAI,EAAE,CAAC;gBACb,KAAK,gBAAgB;oBACnB,IAAA,gBAAM,EAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;oBAChC,MAAM;gBACR,KAAK,uBAAuB;oBAC1B,IAAA,oBAAU,GAAE,CAAC;oBACb,MAAM;gBACR,KAAK,mBAAmB;oBACtB,IAAA,iBAAO,EAAC,IAAI,CAAC,KAAK,CAAC,CAAC;oBACpB,MAAM;gBACR,KAAK,gBAAgB;oBACnB,IAAA,gBAAM,GAAE,CAAC;oBACT,MAAM;gBACR,KAAK,sBAAsB;oBACzB,IAAA,mBAAS,EAAC,IAAI,CAAC,MAAM,CAAC,CAAC;oBACvB,MAAM;YACV,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;AACd,CAAC","sourcesContent":["import { addGlobalDomEventListener } from 'expo/dom/global';\nimport React from 'react';\n\nimport type { RouterStore } from '../global-state/router-store';\nimport {\n  dismiss,\n  dismissAll,\n  goBack,\n  linkTo,\n  setParams,\n  type LinkToOptions,\n} from '../global-state/routing';\n\nconst ROUTER_LINK_TYPE = '$$router_link';\nconst ROUTER_DISMISS_ALL_TYPE = '$$router_dismissAll';\nconst ROUTER_DISMISS_TYPE = '$$router_dismiss';\nconst ROUTER_BACK_TYPE = '$$router_goBack';\nconst ROUTER_SET_PARAMS_TYPE = '$$router_setParams';\n\nfunction emitDomEvent(type: string, data: any = {}) {\n  // @ts-expect-error: ReactNativeWebView is a global variable injected by the WebView\n  if (typeof ReactNativeWebView !== 'undefined') {\n    (window as any).ReactNativeWebView.postMessage(JSON.stringify({ type, data }));\n    return true;\n  }\n  return false;\n}\n\nexport function emitDomSetParams(\n  params: Record<string, undefined | string | number | (string | number)[]> = {}\n) {\n  return emitDomEvent(ROUTER_SET_PARAMS_TYPE, { params });\n}\n\nexport function emitDomDismiss(count?: number) {\n  return emitDomEvent(ROUTER_DISMISS_TYPE, { count });\n}\n\nexport function emitDomGoBack() {\n  return emitDomEvent(ROUTER_BACK_TYPE);\n}\n\nexport function emitDomDismissAll() {\n  return emitDomEvent(ROUTER_DISMISS_ALL_TYPE);\n}\n\nexport function emitDomLinkEvent(href: string, options: LinkToOptions) {\n  return emitDomEvent(ROUTER_LINK_TYPE, { href, options });\n}\n\nexport function useDomComponentNavigation(store: RouterStore) {\n  React.useEffect(() => {\n    if (process.env.EXPO_OS === 'web') {\n      return () => {};\n    }\n    return addGlobalDomEventListener<any>(({ type, data }) => {\n      switch (type) {\n        case ROUTER_LINK_TYPE:\n          linkTo(data.href, data.options);\n          break;\n        case ROUTER_DISMISS_ALL_TYPE:\n          dismissAll();\n          break;\n        case ROUTER_DISMISS_TYPE:\n          dismiss(data.count);\n          break;\n        case ROUTER_BACK_TYPE:\n          goBack();\n          break;\n        case ROUTER_SET_PARAMS_TYPE:\n          setParams(data.params);\n          break;\n      }\n    });\n  }, [store]);\n}\n"]}