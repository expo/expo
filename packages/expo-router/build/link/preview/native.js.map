{"version":3,"file":"native.js","sourceRoot":"","sources":["../../../src/link/preview/native.tsx"],"names":[],"mappings":"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","sourcesContent":["'use client';\n\nimport { requireNativeView } from 'expo';\nimport type { PropsWithChildren } from 'react';\nimport { Platform, StyleSheet, type ViewProps } from 'react-native';\nimport type { SFSymbol } from 'sf-symbols-typescript';\n\nconst areNativeViewsAvailable =\n  process.env.EXPO_OS === 'ios' && !Platform.isTV && global.RN$Bridgeless === true;\n\n// #region Action View\nexport interface NativeLinkPreviewActionProps {\n  title: string;\n  icon?: string;\n  children?: React.ReactNode;\n  disabled?: boolean;\n  destructive?: boolean;\n  // This may lead to race conditions, when two menu actions are on at the same time.\n  // The logic should be enforced in the JS code, rather than in the native code.\n  // singleSelection?: boolean;\n  displayAsPalette?: boolean;\n  displayInline?: boolean;\n  isOn?: boolean;\n  // There are issues with menu state updates when keep presented is set to true.\n  // When updating the context menu state, it will either not update or it will recreate the menu. The latter is a problem,\n  // because it will close all opened submenus and reset the scroll position.\n  // TODO: (@ubax) find a way to fix this.\n  keepPresented?: boolean;\n  onSelected: () => void;\n}\nconst LinkPreviewNativeActionView: React.ComponentType<NativeLinkPreviewActionProps> | null =\n  areNativeViewsAvailable\n    ? requireNativeView('ExpoRouterNativeLinkPreview', 'LinkPreviewNativeActionView')\n    : null;\nexport function NativeLinkPreviewAction(props: NativeLinkPreviewActionProps) {\n  if (!LinkPreviewNativeActionView) {\n    return null;\n  }\n  return <LinkPreviewNativeActionView {...props} />;\n}\n// #endregion\n\n// #region Preview View\nexport interface TabPath {\n  oldTabKey: string;\n  newTabKey: string;\n}\nexport interface NativeLinkPreviewProps extends ViewProps {\n  nextScreenId: string | undefined;\n  tabPath:\n    | {\n        path: TabPath[];\n      }\n    | undefined;\n  disableForceFlatten?: boolean;\n  onWillPreviewOpen?: () => void;\n  onDidPreviewOpen?: () => void;\n  onPreviewWillClose?: () => void;\n  onPreviewDidClose?: () => void;\n  onPreviewTapped?: () => void;\n  onPreviewTappedAnimationCompleted?: () => void;\n  children: React.ReactNode;\n}\nconst NativeLinkPreviewView: React.ComponentType<NativeLinkPreviewProps> | null =\n  areNativeViewsAvailable\n    ? requireNativeView('ExpoRouterNativeLinkPreview', 'NativeLinkPreviewView')\n    : null;\nexport function NativeLinkPreview(props: NativeLinkPreviewProps) {\n  if (!NativeLinkPreviewView) {\n    return null;\n  }\n  return <NativeLinkPreviewView {...props} />;\n}\n// #endregion\n\nconst LinkPreviewNativeZoomTransitionEnablerView: React.ComponentType<\n  ViewProps & { zoomTransitionSourceIdentifier: string }\n> | null = areNativeViewsAvailable\n  ? requireNativeView('ExpoRouterNativeLinkPreview', 'LinkPreviewNativeZoomTransitionEnabler')\n  : null;\nexport function LinkPreviewNativeZoomTransitionEnabler(\n  props: PropsWithChildren<{ zoomTransitionSourceIdentifier: string }>\n) {\n  if (!LinkPreviewNativeZoomTransitionEnablerView) {\n    return null;\n  }\n  return (\n    <LinkPreviewNativeZoomTransitionEnablerView\n      {...props}\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: 1,\n        height: 1,\n        backgroundColor: 'transparent',\n      }}\n    />\n  );\n}\n\nconst LinkPreviewNativeZoomTransitionSourceView: React.ComponentType<\n  ViewProps & { identifier: string; disableForceFlatten?: boolean }\n> | null = areNativeViewsAvailable\n  ? requireNativeView('ExpoRouterNativeLinkPreview', 'LinkPreviewNativeZoomTransitionSource')\n  : null;\nexport function LinkPreviewNativeZoomTransitionSource(props: {\n  identifier: string;\n  children: React.ReactNode;\n}) {\n  if (!LinkPreviewNativeZoomTransitionSourceView) {\n    return null;\n  }\n  return (\n    <LinkPreviewNativeZoomTransitionSourceView\n      {...props}\n      style={{ display: 'contents' }}\n      disableForceFlatten\n    />\n  );\n}\n\nconst RouterToolbarHostView: React.ComponentType<ViewProps> | null = areNativeViewsAvailable\n  ? requireNativeView('ExpoRouterNativeLinkPreview', 'RouterToolbarHost')\n  : null;\nexport function RouterToolbarHost(props: PropsWithChildren) {\n  if (!RouterToolbarHostView) {\n    return null;\n  }\n  return (\n    <RouterToolbarHostView\n      {...props}\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: 1,\n        height: 1,\n        backgroundColor: 'transparent',\n      }}\n    />\n  );\n}\n\nconst RouterToolbarItemView: React.ComponentType<\n  ViewProps & { identifier: string; title?: string; systemImageName?: SFSymbol; type?: string }\n> | null = areNativeViewsAvailable\n  ? requireNativeView('ExpoRouterNativeLinkPreview', 'RouterToolbarItem')\n  : null;\nexport function RouterToolbarItem(props: {\n  identifier: string;\n  title?: string;\n  systemImageName?: SFSymbol;\n  spacer?: boolean;\n}) {\n  if (!RouterToolbarItemView) {\n    return null;\n  }\n  return <RouterToolbarItemView {...props} type={props.spacer ? 'spacer' : ''} />;\n}\n\n// #region Preview Content View\nexport interface NativeLinkPreviewContentProps extends ViewProps {\n  preferredContentSize?: { width: number; height: number };\n}\nconst NativeLinkPreviewContentView: React.ComponentType<NativeLinkPreviewContentProps> | null =\n  areNativeViewsAvailable\n    ? requireNativeView('ExpoRouterNativeLinkPreview', 'NativeLinkPreviewContentView')\n    : null;\n\nexport function NativeLinkPreviewContent(props: NativeLinkPreviewContentProps) {\n  if (!NativeLinkPreviewContentView) {\n    return null;\n  }\n  const style = StyleSheet.flatten([\n    props.style,\n    {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n    } as const,\n  ]);\n  return <NativeLinkPreviewContentView {...props} style={style} />;\n}\n// #endregion\n"]}