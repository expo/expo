{"version":3,"file":"useZoomTransitionPrimitives.ios.js","sourceRoot":"","sources":["../../../src/link/zoom/useZoomTransitionPrimitives.ios.tsx"],"names":[],"mappings":";AAAA,YAAY,CAAC;;AAUb,kEAqEC;AA7ED,kDAA2C;AAC3C,iCAAkE;AAElE,mEAAkE;AAClE,6DAAmG;AACnG,wEAA8D;AAG9D,SAAgB,2BAA2B,CAAC,EAAE,IAAI,EAAE,OAAO,EAAa;IACtE,MAAM,SAAS,GAAG,IAAA,kCAAY,GAAE,CAAC;IACjC,MAAM,gBAAgB,GAAG,IAAA,eAAO,EAC9B,GAAG,EAAE,CACH,CAAC,SAAS,IAAI,OAAO,CAAC,GAAG,CAAC,OAAO,KAAK,KAAK,IAAI,IAAA,+CAAuB,GAAE;QACtE,CAAC,CAAC,IAAA,mBAAM,GAAE;QACV,CAAC,CAAC,SAAS,EACf,EAAE,CACH,CAAC;IAEF,MAAM,CAAC,eAAe,EAAE,kBAAkB,CAAC,GAAG,IAAA,gBAAQ,EAAC,CAAC,CAAC,CAAC;IAC1D,MAAM,SAAS,GAAG,IAAA,mBAAW,EAAC,GAAG,EAAE;QACjC,kBAAkB,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC;IACzC,CAAC,EAAE,EAAE,CAAC,CAAC;IACP,MAAM,YAAY,GAAG,IAAA,mBAAW,EAAC,GAAG,EAAE;QACpC,kBAAkB,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC;IACzC,CAAC,EAAE,EAAE,CAAC,CAAC;IAEP,MAAM,aAAa,GAAG,eAAe,GAAG,CAAC,CAAC;IAE1C,IAAA,iBAAS,EAAC,GAAG,EAAE;QACb,IAAI,eAAe,GAAG,CAAC,EAAE,CAAC;YACxB,MAAM,IAAI,KAAK,CACb,8FAA8F,CAC/F,CAAC;QACJ,CAAC;IACH,CAAC,EAAE,CAAC,eAAe,CAAC,CAAC,CAAC;IAEtB,IAAA,iBAAS,EAAC,GAAG,EAAE;QACb,IAAI,aAAa,IAAI,CAAC,OAAO,EAAE,CAAC;YAC9B,OAAO,CAAC,IAAI,CACV,+JAA+J,CAChK,CAAC;QACJ,CAAC;IACH,CAAC,EAAE,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC,CAAC;IAE7B,MAAM,gCAAgC,GAAG,IAAA,eAAO,EAAC,GAAG,EAAE;QACpD,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACtB,OAAO,SAAS,CAAC;QACnB,CAAC;QACD,OAAO;YACL,UAAU,EAAE,gBAAgB;YAC5B,SAAS;YACT,YAAY;YACZ,YAAY,EAAE,CAAC,aAAa;SAC7B,CAAC;IACJ,CAAC,EAAE,CAAC,gBAAgB,EAAE,SAAS,EAAE,YAAY,EAAE,aAAa,CAAC,CAAC,CAAC;IAE/D,MAAM,YAAY,GAAG,IAAA,eAAO,EAAC,GAAG,EAAE;QAChC,IAAI,CAAC,aAAa,IAAI,CAAC,gBAAgB,EAAE,CAAC;YACxC,OAAO,IAAI,CAAC;QACd,CAAC;QACD,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE,CAAC;YAC7B,OAAO;gBACL,QAAQ,EAAE,IAAI;gBACd,MAAM,EAAE;oBACN,CAAC,4EAAyD,CAAC,EAAE,gBAAgB;iBAC9E;aACF,CAAC;QACJ,CAAC;QACD,OAAO;YACL,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,MAAM,EAAE;gBACN,GAAG,CAAC,IAAI,CAAC,MAAM,IAAI,EAAE,CAAC;gBACtB,CAAC,4EAAyD,CAAC,EAAE,gBAAgB;aAC9E;SACF,CAAC;IACJ,CAAC,EAAE,CAAC,IAAI,EAAE,gBAAgB,EAAE,aAAa,CAAC,CAAC,CAAC;IAC5C,OAAO,EAAE,gCAAgC,EAAE,IAAI,EAAE,YAAY,EAAE,CAAC;AAClE,CAAC","sourcesContent":["'use client';\n\nimport { nanoid } from 'nanoid/non-secure';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { isZoomTransitionEnabled } from './ZoomTransitionEnabler';\nimport { INTERNAL_EXPO_ROUTER_ZOOM_TRANSITION_SOURCE_ID_PARAM_NAME } from '../../navigationParams';\nimport { useIsPreview } from '../preview/PreviewRouteContext';\nimport { LinkProps } from '../useLinkHooks';\n\nexport function useZoomTransitionPrimitives({ href, asChild }: LinkProps) {\n  const isPreview = useIsPreview();\n  const zoomTransitionId = useMemo(\n    () =>\n      !isPreview && process.env.EXPO_OS === 'ios' && isZoomTransitionEnabled()\n        ? nanoid()\n        : undefined,\n    []\n  );\n\n  const [numberOfSources, setNumberOfSources] = useState(0);\n  const addSource = useCallback(() => {\n    setNumberOfSources((prev) => prev + 1);\n  }, []);\n  const removeSource = useCallback(() => {\n    setNumberOfSources((prev) => prev - 1);\n  }, []);\n\n  const hasZoomSource = numberOfSources > 0;\n\n  useEffect(() => {\n    if (numberOfSources > 1) {\n      throw new Error(\n        '[expo-router] Only one Link.ZoomTransitionSource can be used within a single Link component.'\n      );\n    }\n  }, [numberOfSources]);\n\n  useEffect(() => {\n    if (hasZoomSource && !asChild) {\n      console.warn(\n        '[expo-router] Using zoom transition links without `asChild` prop may lead to unexpected behavior. Please ensure to set `asChild` when using zoom transitions.'\n      );\n    }\n  }, [hasZoomSource, asChild]);\n\n  const zoomTransitionSourceContextValue = useMemo(() => {\n    if (!zoomTransitionId) {\n      return undefined;\n    }\n    return {\n      identifier: zoomTransitionId,\n      addSource,\n      removeSource,\n      canAddSource: !hasZoomSource,\n    };\n  }, [zoomTransitionId, addSource, removeSource, hasZoomSource]);\n\n  const computedHref = useMemo(() => {\n    if (!hasZoomSource || !zoomTransitionId) {\n      return href;\n    }\n    if (typeof href === 'string') {\n      return {\n        pathname: href,\n        params: {\n          [INTERNAL_EXPO_ROUTER_ZOOM_TRANSITION_SOURCE_ID_PARAM_NAME]: zoomTransitionId,\n        },\n      };\n    }\n    return {\n      pathname: href.pathname,\n      params: {\n        ...(href.params ?? {}),\n        [INTERNAL_EXPO_ROUTER_ZOOM_TRANSITION_SOURCE_ID_PARAM_NAME]: zoomTransitionId,\n      },\n    };\n  }, [href, zoomTransitionId, hasZoomSource]);\n  return { zoomTransitionSourceContextValue, href: computedHref };\n}\n"]}