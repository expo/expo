{"version":3,"file":"StackElements.js","sourceRoot":"","sources":["../../src/layouts/StackElements.tsx"],"names":[],"mappings":"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","sourcesContent":["'use client';\nimport { NativeStackNavigationOptions } from '@react-navigation/native-stack';\nimport { createContext, use, useCallback, useLayoutEffect, useMemo } from 'react';\nimport { StyleSheet } from 'react-native';\n\nimport type {\n  StackHeaderBackButtonProps,\n  StackHeaderLeftProps,\n  StackHeaderProps,\n  StackHeaderRightProps,\n  StackHeaderTitleProps,\n  StackHeaderSearchBarProps,\n  StackHeaderConfigurationContextValue,\n  StackScreensConfigurationContextValue,\n  StackScreenConfigurationContextValue,\n  StackScreenProps,\n} from './StackElements.types';\nimport { useNavigation } from '../useNavigation';\nimport { Screen } from '../views/Screen';\n\nexport const StackHeaderConfigurationContext = createContext<\n  StackHeaderConfigurationContextValue | undefined\n>(undefined);\n\nfunction StackHeaderComponent({\n  asChild,\n  children,\n  hidden,\n  blurEffect,\n  style,\n  largeStyle,\n}: StackHeaderProps) {\n  const contextValue = use(ScreenOptionsContext);\n  if (!contextValue) {\n    throw new Error(\n      'Stack.Header can only be used inside of a Stack.Screen component in a _layout file.'\n    );\n  }\n  const { setConfiguration } = contextValue;\n  const setHeaderBackButtonConfiguration: StackHeaderConfigurationContextValue['setHeaderBackButtonConfiguration'] =\n    (config) => {\n      setConfiguration({ ...config });\n    };\n  const setHeaderLeftConfiguration: StackHeaderConfigurationContextValue['setHeaderLeftConfiguration'] =\n    (config) => {\n      setConfiguration({ ...config });\n    };\n  const setHeaderRightConfiguration: StackHeaderConfigurationContextValue['setHeaderRightConfiguration'] =\n    (config) => {\n      setConfiguration({ ...config });\n    };\n  const setHeaderSearchBarConfiguration: StackHeaderConfigurationContextValue['setHeaderSearchBarConfiguration'] =\n    (config) => {\n      setConfiguration({ ...config });\n    };\n  const setHeaderTitleConfiguration: StackHeaderConfigurationContextValue['setHeaderTitleConfiguration'] =\n    (config) => {\n      setConfiguration({ ...config });\n    };\n\n  const currentConfig = useMemo<NativeStackNavigationOptions>(() => {\n    const flattenedStyle = StyleSheet.flatten(style);\n    const flattenedLargeStyle = StyleSheet.flatten(largeStyle);\n    return {\n      headerShown: !hidden,\n      headerBlurEffect: blurEffect,\n      headerStyle: {\n        backgroundColor: flattenedStyle?.backgroundColor as string | undefined,\n      },\n      headerLargeStyle: {\n        backgroundColor: flattenedLargeStyle?.backgroundColor as string | undefined,\n      },\n      headerShadowVisible: flattenedStyle?.shadowColor !== 'transparent',\n      headerLargeTitleShadowVisible: flattenedLargeStyle?.shadowColor !== 'transparent',\n    };\n  }, [hidden, blurEffect, style, largeStyle]);\n\n  useLayoutEffect(() => {\n    if (hidden) {\n      setConfiguration({ headerShown: false });\n    } else if (asChild) {\n      setConfiguration({ header: () => children });\n    } else {\n      setConfiguration({ ...currentConfig });\n    }\n  }, [asChild, hidden, currentConfig]);\n\n  if (asChild) {\n    return null;\n  }\n\n  return (\n    <StackHeaderConfigurationContext\n      value={{\n        setHeaderBackButtonConfiguration,\n        setHeaderLeftConfiguration,\n        setHeaderRightConfiguration,\n        setHeaderSearchBarConfiguration,\n        setHeaderTitleConfiguration,\n      }}>\n      {children}\n    </StackHeaderConfigurationContext>\n  );\n}\n\nfunction StackHeaderLeft({ asChild, children }: StackHeaderLeftProps) {\n  const contextValue = use(StackHeaderConfigurationContext);\n  if (!contextValue) {\n    throw new Error(\n      'Stack.Header.Left can only be used inside of a Stack.Header component in a _layout file.'\n    );\n  }\n  const { setHeaderLeftConfiguration } = contextValue;\n  useLayoutEffect(() => {\n    const config = asChild ? { headerLeft: () => children } : {};\n    setHeaderLeftConfiguration(config);\n  }, [children, asChild]);\n  return null;\n}\n\nfunction StackHeaderRight({ asChild, children }: StackHeaderRightProps) {\n  const contextValue = use(StackHeaderConfigurationContext);\n  if (!contextValue) {\n    throw new Error(\n      'Stack.Header.Right can only be used inside of a Stack.Header component in a _layout file.'\n    );\n  }\n  const { setHeaderRightConfiguration } = contextValue;\n  useLayoutEffect(() => {\n    const config = asChild ? { headerRight: () => children } : {};\n    setHeaderRightConfiguration(config);\n  }, [children, asChild]);\n  return null;\n}\n\nfunction StackHeaderBackButton({\n  children,\n  style,\n  withMenu,\n  displayMode,\n  src,\n  hidden,\n}: StackHeaderBackButtonProps) {\n  const contextValue = use(StackHeaderConfigurationContext);\n  if (!contextValue) {\n    throw new Error(\n      'Stack.Header.BackButton can only be used inside of a Stack.Header component in a _layout file.'\n    );\n  }\n  const { setHeaderBackButtonConfiguration } = contextValue;\n  useLayoutEffect(() => {\n    setHeaderBackButtonConfiguration({\n      headerBackTitle: children,\n      headerBackTitleStyle: style,\n      headerBackImageSource: src,\n      headerBackButtonDisplayMode: displayMode,\n      headerBackButtonMenuEnabled: withMenu,\n      headerBackVisible: !hidden,\n    });\n  }, []);\n  return null;\n}\n\nfunction StackHeaderTitle({ children, style, large, largeStyle }: StackHeaderTitleProps) {\n  const contextValue = use(StackHeaderConfigurationContext);\n  if (!contextValue) {\n    throw new Error(\n      'Stack.Header.Title can only be used inside of a Stack.Header component in a _layout file.'\n    );\n  }\n  const { setHeaderTitleConfiguration } = contextValue;\n  useLayoutEffect(() => {\n    const flattenedStyle = StyleSheet.flatten(style);\n    const flattenedLargeStyle = StyleSheet.flatten(largeStyle);\n    setHeaderTitleConfiguration({\n      headerTitle: children,\n      headerLargeTitle: large,\n      headerTitleAlign: flattenedStyle?.textAlign,\n      headerTitleStyle: {\n        ...flattenedStyle,\n        // This is needed because React Navigation expects color to be a string\n        color: (flattenedStyle?.color as string) ?? undefined,\n      },\n      headerLargeTitleStyle: {\n        ...flattenedLargeStyle,\n        fontWeight: flattenedLargeStyle?.fontWeight?.toString(),\n        // This is needed because React Navigation expects color to be a string\n        color: (flattenedLargeStyle?.color as string) ?? undefined,\n      },\n    });\n  }, [children, style, large, largeStyle]);\n  return null;\n}\n\nfunction StackHeaderSearchBar(props: StackHeaderSearchBarProps) {\n  const contextValue = use(StackHeaderConfigurationContext);\n  useLayoutEffect(() => {\n    if (!contextValue) {\n      throw new Error(\n        'Stack.Header.SearchBar can only be used inside of a Stack.Header component in a _layout file.'\n      );\n    }\n    const { setHeaderSearchBarConfiguration } = contextValue;\n    setHeaderSearchBarConfiguration({\n      headerSearchBarOptions: props,\n    });\n  }, [props]);\n  return null;\n}\n\nexport const ScreensOptionsContext = createContext<\n  StackScreensConfigurationContextValue | undefined\n>(undefined);\n\nexport const ScreenOptionsContext = createContext<StackScreenConfigurationContextValue | undefined>(\n  undefined\n);\n\nexport const IsWithinCompositionConfiguration = createContext<boolean>(false);\n\nexport function StackScreen({ children, ...rest }: StackScreenProps) {\n  if (use(IsWithinCompositionConfiguration)) {\n    return <StackScreenInner {...rest} children={children} />;\n  } else {\n    return <Screen {...rest} />;\n  }\n}\n\nfunction StackScreenInner({ name, options, children, ...rest }: StackScreenProps) {\n  const navigation = useNavigation();\n\n  const setConfiguration = useCallback<StackScreenConfigurationContextValue['setConfiguration']>(\n    (configUpdater) => {\n      navigation.setOptions(configUpdater);\n    },\n    [navigation]\n  );\n\n  return <ScreenOptionsContext value={{ setConfiguration }}>{children}</ScreenOptionsContext>;\n}\n\nexport const StackHeader = Object.assign(StackHeaderComponent, {\n  Left: StackHeaderLeft,\n  Right: StackHeaderRight,\n  BackButton: StackHeaderBackButton,\n  Title: StackHeaderTitle,\n  SearchBar: StackHeaderSearchBar,\n});\n"]}