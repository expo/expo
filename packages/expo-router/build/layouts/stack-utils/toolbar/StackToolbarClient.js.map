{"version":3,"file":"StackToolbarClient.js","sourceRoot":"","sources":["../../../../src/layouts/stack-utils/toolbar/StackToolbarClient.tsx"],"names":[],"mappings":"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","sourcesContent":["'use client';\nimport { NativeStackNavigationOptions } from '@react-navigation/native-stack';\nimport React, { Fragment, isValidElement, useEffect, type ReactNode } from 'react';\nimport { useMemo } from 'react';\n\nimport {\n  convertStackToolbarButtonPropsToRNHeaderItem,\n  StackToolbarButton,\n} from './StackToolbarButton';\nimport {\n  convertStackToolbarMenuPropsToRNHeaderItem,\n  StackToolbarMenu,\n  StackToolbarMenuAction,\n} from './StackToolbarMenu';\nimport { StackToolbarSearchBarSlot } from './StackToolbarSearchBarSlot';\nimport {\n  convertStackToolbarSpacerPropsToRNHeaderItem,\n  StackToolbarSpacer,\n} from './StackToolbarSpacer';\nimport { convertStackToolbarViewPropsToRNHeaderItem, StackToolbarView } from './StackToolbarView';\nimport { ToolbarPlacementContext, useToolbarPlacement, type ToolbarPlacement } from './context';\nimport { StackToolbarBadge, StackToolbarIcon, StackToolbarLabel } from './toolbar-primitives';\nimport { NativeMenuContext } from '../../../link/NativeMenuContext';\nimport { RouterToolbarHost } from '../../../toolbar/native';\nimport { useNavigation } from '../../../useNavigation';\nimport { isChildOfType } from '../../../utils/children';\nimport { Screen } from '../../../views/Screen';\n\nexport interface StackToolbarProps {\n  /**\n   * Child elements to compose the toolbar. Can include Stack.Toolbar.Button,\n   * Stack.Toolbar.Menu, Stack.Toolbar.View, Stack.Toolbar.Spacer, and\n   * Stack.Toolbar.SearchBarSlot (bottom only) components.\n   */\n  children?: ReactNode;\n  /**\n   * The placement of the toolbar.\n   *\n   * - `'left'`: Renders items in the left area of the header.\n   * - `'right'`: Renders items in the right area of the header.\n   * - `'bottom'`: Renders items in the bottom toolbar (iOS only).\n   *\n   * @default 'bottom'\n   */\n  placement?: ToolbarPlacement;\n  /**\n   * When `true`, renders children as a custom component in the header area,\n   * replacing the default header layout.\n   *\n   * Only applies to `placement=\"left\"` and `placement=\"right\"`.\n   *\n   * @default false\n   */\n  asChild?: boolean;\n}\n\n/**\n * The component used to configure the stack toolbar.\n *\n * - Use `placement=\"left\"` to customize the left side of the header.\n * - Use `placement=\"right\"` to customize the right side of the header.\n * - Use `placement=\"bottom\"` (default) to show a bottom toolbar (iOS only).\n *\n * > **Note:** Using `Stack.Toolbar` with `placement=\"left\"` or `placement=\"right\"` will\n * automatically make the header visible (`headerShown: true`), as the toolbar is rendered\n * as part of the native header.\n *\n * > **Note:** `Stack.Toolbar` with `placement=\"bottom\"` can only be used inside **page**\n * components, not in layout components.\n *\n * > **Note**: Stack.Toolbar is an experimental API and may change without notice.\n *\n * @example\n * ```tsx\n * import { Stack } from 'expo-router';\n *\n * export default function Layout() {\n *   return (\n *     <Stack>\n *       <Stack.Screen name=\"index\">\n *         <Stack.Toolbar placement=\"left\">\n *           <Stack.Toolbar.Button icon=\"sidebar.left\" onPress={() => alert('Left button pressed!')} />\n *         </Stack.Toolbar>\n *         <Stack.Toolbar placement=\"right\">\n *           <Stack.Toolbar.Button icon=\"ellipsis.circle\" onPress={() => alert('Right button pressed!')} />\n *         </Stack.Toolbar>\n *       </Stack.Screen>\n *     </Stack>\n *   );\n * }\n * ```\n *\n * @example\n * ```tsx\n * import { Stack } from 'expo-router';\n *\n * export default function Page() {\n *   return (\n *     <>\n *       <Stack.Toolbar placement=\"left\">\n *         <Stack.Toolbar.Button icon=\"sidebar.left\" onPress={() => alert('Left button pressed!')} />\n *       </Stack.Toolbar>\n *       <Stack.Toolbar>\n *         <Stack.Toolbar.Spacer />\n *         <Stack.Toolbar.Button icon=\"magnifyingglass\" onPress={() => {}} />\n *         <Stack.Toolbar.Spacer />\n *       </Stack.Toolbar>\n *       <ScreenContent />\n *     </>\n *   );\n * }\n * ```\n *\n * @platform ios\n */\nexport const StackToolbar = (props: StackToolbarProps) => {\n  const parentPlacement = useToolbarPlacement();\n  if (parentPlacement) {\n    throw new Error(`Stack.Toolbar cannot be nested inside another Stack.Toolbar.`);\n  }\n\n  if (props.placement === 'bottom' || !props.placement) {\n    return <StackToolbarBottom {...props} />;\n  }\n\n  return <StackToolbarHeader {...props} key={props.placement} />;\n};\n\nconst StackToolbarBottom = ({ children }: StackToolbarProps) => {\n  return (\n    <ToolbarPlacementContext.Provider value=\"bottom\">\n      <NativeMenuContext value>\n        <RouterToolbarHost>{children}</RouterToolbarHost>\n      </NativeMenuContext>\n    </ToolbarPlacementContext.Provider>\n  );\n};\n\nconst StackToolbarHeader = ({ children, placement, asChild }: StackToolbarProps) => {\n  const navigation = useNavigation();\n\n  if (placement !== 'left' && placement !== 'right') {\n    throw new Error(\n      `Invalid placement \"${placement}\" for Stack.Toolbar. Expected \"left\" or \"right\".`\n    );\n  }\n\n  useEffect(() => {\n    return () => {\n      const optionKey =\n        placement === 'right' ? 'unstable_headerRightItems' : 'unstable_headerLeftItems';\n      navigation.setOptions({\n        [optionKey]: () => [],\n      } as NativeStackNavigationOptions);\n    };\n  }, [navigation, placement]);\n\n  const updatedOptions = useMemo(\n    () => appendStackToolbarPropsToOptions({}, { children, placement, asChild }),\n    [children, placement, asChild]\n  );\n\n  return (\n    <ToolbarPlacementContext.Provider value={placement}>\n      <Screen options={updatedOptions} />\n    </ToolbarPlacementContext.Provider>\n  );\n};\n\nfunction convertToolbarChildrenToUnstableItems(\n  children: React.ReactNode,\n  side: 'left' | 'right'\n):\n  | NativeStackNavigationOptions['unstable_headerRightItems']\n  | NativeStackNavigationOptions['unstable_headerLeftItems'] {\n  const allChildren = React.Children.toArray(children);\n  const actions = allChildren.filter(\n    (child) =>\n      isChildOfType(child, StackToolbarButton) ||\n      isChildOfType(child, StackToolbarMenu) ||\n      isChildOfType(child, StackToolbarSpacer) ||\n      isChildOfType(child, StackToolbarView)\n  );\n  if (actions.length !== allChildren.length && process.env.NODE_ENV !== 'production') {\n    const otherElements = allChildren\n      .filter((child) => !actions.some((action) => action === child))\n      .map((e) => {\n        if (isValidElement(e)) {\n          if (e.type === Fragment) {\n            return '<Fragment>';\n          } else {\n            return (e.type as { name: string })?.name ?? e.type;\n          }\n        }\n\n        return String(e);\n      });\n    console.warn(\n      `Stack.Toolbar with placement=\"${side}\" only accepts <Stack.Toolbar.Button>, <Stack.Toolbar.Menu>, <Stack.Toolbar.View>, and <Stack.Toolbar.Spacer> as children. Found invalid children: ${otherElements.join(', ')}`\n    );\n  }\n  return () =>\n    actions\n      .map((action) => {\n        if (isChildOfType(action, StackToolbarButton)) {\n          return convertStackToolbarButtonPropsToRNHeaderItem(action.props);\n        } else if (isChildOfType(action, StackToolbarMenu)) {\n          return convertStackToolbarMenuPropsToRNHeaderItem(action.props);\n        } else if (isChildOfType(action, StackToolbarSpacer)) {\n          return convertStackToolbarSpacerPropsToRNHeaderItem(action.props);\n        }\n        return convertStackToolbarViewPropsToRNHeaderItem(action.props);\n      })\n      .filter((item) => !!item);\n}\n\nexport function appendStackToolbarPropsToOptions(\n  options: NativeStackNavigationOptions,\n  props: StackToolbarProps\n): NativeStackNavigationOptions {\n  const { children, placement = 'bottom', asChild } = props;\n\n  if (placement === 'bottom') {\n    // Bottom toolbar doesn't modify navigation options\n    return options;\n  }\n\n  if (asChild) {\n    if (placement === 'left') {\n      return {\n        ...options,\n        headerShown: true,\n        headerLeft: () => children,\n      };\n    } else {\n      return {\n        ...options,\n        headerShown: true,\n        headerRight: () => children,\n      };\n    }\n  }\n\n  if (placement === 'left') {\n    return {\n      ...options,\n      headerShown: true,\n      unstable_headerLeftItems: convertToolbarChildrenToUnstableItems(children, 'left'),\n    };\n  }\n\n  return {\n    ...options,\n    headerShown: true,\n    unstable_headerRightItems: convertToolbarChildrenToUnstableItems(children, 'right'),\n  };\n}\n\nStackToolbar.Button = StackToolbarButton;\nStackToolbar.Menu = StackToolbarMenu;\nStackToolbar.MenuAction = StackToolbarMenuAction;\nStackToolbar.SearchBarSlot = StackToolbarSearchBarSlot;\nStackToolbar.Spacer = StackToolbarSpacer;\nStackToolbar.View = StackToolbarView;\nStackToolbar.Label = StackToolbarLabel;\nStackToolbar.Icon = StackToolbarIcon;\nStackToolbar.Badge = StackToolbarBadge;\n\nexport default StackToolbar;\n"]}