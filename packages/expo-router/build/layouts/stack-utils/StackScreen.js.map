{"version":3,"file":"StackScreen.js","sourceRoot":"","sources":["../../../src/layouts/stack-utils/StackScreen.tsx"],"names":[],"mappings":"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","sourcesContent":["'use client';\nimport { NativeStackNavigationOptions } from '@react-navigation/native-stack';\nimport { Children, isValidElement, useMemo, type PropsWithChildren, type ReactNode } from 'react';\n\nimport { StackHeaderComponent, appendStackHeaderPropsToOptions } from './StackHeaderComponent';\nimport {\n  StackScreenTitle,\n  appendStackScreenTitlePropsToOptions,\n  StackScreenBackButton,\n  appendStackScreenBackButtonPropsToOptions,\n} from './screen';\nimport { StackToolbar, appendStackToolbarPropsToOptions, type StackToolbarProps } from './toolbar';\nimport { getAllChildrenOfType, isChildOfType } from '../../utils/children';\nimport { Screen } from '../../views/Screen';\n\nexport interface StackScreenProps extends PropsWithChildren {\n  name?: string;\n  options?: NativeStackNavigationOptions;\n}\n\nfunction extractBottomToolbars(children: ReactNode): React.ReactElement<StackToolbarProps>[] {\n  return (\n    getAllChildrenOfType(children, StackToolbar).filter(\n      (child) => child.props.placement === 'bottom' || child.props.placement === undefined\n    ) ?? []\n  );\n}\n\n/**\n * Component used to define a screen in a native stack navigator.\n *\n * Can be used in the `_layout.tsx` files, or directly in page components.\n *\n * When configuring header inside page components, prefer using `Stack.Toolbar`, `Stack.Header` and `Stack.Screen.*` components\n *\n * @example\n * ```tsx app/_layout.tsx\n * import { Stack } from 'expo-router';\n *\n * export default function Layout() {\n *   return (\n *     <Stack>\n *       <Stack.Screen\n *         name=\"home\"\n *         options={{ title: 'Home' }}\n *       />\n *    </Stack>\n *  );\n * }\n * ```\n *\n * @example\n * ```tsx app/home.tsx\n * import { Stack } from 'expo-router';\n *\n * export default function HomePage() {\n *   return (\n *     <>\n *       <Stack.Screen\n *         options={{ headerTransparent: true }}\n *       />\n *       <Stack.Screen.Title>Welcome Home</Stack.Screen.Title>\n *       // Page content\n *     </>\n *   );\n * }\n * ```\n */\nexport const StackScreen = Object.assign(\n  function StackScreen({ children, options, ...rest }: StackScreenProps) {\n    // This component will only render when used inside a page.\n    const updatedOptions = useMemo(\n      () =>\n        appendScreenStackPropsToOptions(options ?? {}, {\n          children,\n        }),\n      [options, children]\n    );\n\n    const bottomToolbars = useMemo(() => extractBottomToolbars(children), [children]);\n\n    return (\n      <>\n        <Screen {...rest} options={updatedOptions} />\n        {/* Bottom toolbar is a native component rendered separately */}\n        {bottomToolbars}\n      </>\n    );\n  },\n  {\n    Title: StackScreenTitle,\n    BackButton: StackScreenBackButton,\n  }\n);\n\nexport function appendScreenStackPropsToOptions(\n  options: NativeStackNavigationOptions,\n  props: StackScreenProps\n): NativeStackNavigationOptions {\n  let updatedOptions = { ...options, ...props.options };\n\n  function appendChildOptions(child: React.ReactElement, opts: NativeStackNavigationOptions) {\n    if (isChildOfType(child, StackHeaderComponent)) {\n      return appendStackHeaderPropsToOptions(opts, child.props);\n    }\n\n    if (isChildOfType(child, StackScreenTitle)) {\n      return appendStackScreenTitlePropsToOptions(opts, child.props);\n    }\n\n    if (isChildOfType(child, StackScreenBackButton)) {\n      return appendStackScreenBackButtonPropsToOptions(opts, child.props);\n    }\n\n    if (isChildOfType(child, StackToolbar)) {\n      const placement = child.props.placement ?? 'bottom';\n\n      if (placement === 'bottom') {\n        throw new Error(\n          `Stack.Toolbar with placement=\"bottom\" cannot be used inside Stack.Screen in _layout.tsx. Please move it to the page component.`\n        );\n      }\n\n      return appendStackToolbarPropsToOptions(opts, child.props);\n    }\n\n    const typeName =\n      typeof child.type === 'function'\n        ? (child.type as { name?: string }).name || 'Unknown'\n        : String(child.type);\n    console.warn(`Unknown child element passed to Stack.Screen: ${typeName}`);\n    return opts;\n  }\n\n  Children.forEach(props.children, (child) => {\n    if (isValidElement(child)) {\n      updatedOptions = appendChildOptions(child, updatedOptions);\n    }\n  });\n\n  return updatedOptions;\n}\n"]}