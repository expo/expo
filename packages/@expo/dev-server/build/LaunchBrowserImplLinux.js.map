{"version":3,"file":"LaunchBrowserImplLinux.js","names":["LaunchBrowserImplLinux","LaunchBrowserTypes","CHROME","EDGE","getAppId","browserType","_appId","MAP","includes","appId","status","spawnAsync","stdio","Error","join","isSupportedBrowser","result","createTempBrowserDir","baseDirName","path","require","launchAsync","args","_process","open","openApp","arguments","close","kill","undefined"],"sources":["../src/LaunchBrowserImplLinux.ts"],"sourcesContent":["import spawnAsync from '@expo/spawn-async';\nimport { type ChildProcess } from 'child_process';\nimport open from 'open';\nimport path from 'path';\n\nimport {\n  LaunchBrowserTypes,\n  type LaunchBrowserImpl,\n  type LaunchBrowserInstance,\n} from './LaunchBrowser.types';\n\n/**\n * Browser implementation for Linux\n */\nexport default class LaunchBrowserImplLinux implements LaunchBrowserImpl, LaunchBrowserInstance {\n  private _appId: string | undefined;\n  private _process: ChildProcess | undefined;\n\n  MAP = {\n    [LaunchBrowserTypes.CHROME]: ['google-chrome', 'google-chrome-stable', 'chromium'],\n    [LaunchBrowserTypes.EDGE]: ['microsoft-edge', 'microsoft-edge-dev'],\n  };\n\n  /**\n   * On Linux, the supported appId is an array, this function finds the available appId and caches it\n   */\n  private async getAppId(browserType: LaunchBrowserTypes): Promise<string> {\n    if (this._appId == null || !this.MAP[browserType].includes(this._appId)) {\n      for (const appId of this.MAP[browserType]) {\n        try {\n          const { status } = await spawnAsync('which', [appId], { stdio: 'ignore' });\n          if (status === 0) {\n            this._appId = appId;\n            break;\n          }\n        } catch {}\n      }\n    }\n\n    if (this._appId == null) {\n      throw new Error(\n        `Unable to find supported browser - tried[${this.MAP[browserType].join(', ')}]`\n      );\n    }\n\n    return this._appId;\n  }\n\n  async isSupportedBrowser(browserType: LaunchBrowserTypes): Promise<boolean> {\n    let result = false;\n    try {\n      await this.getAppId(browserType);\n      result = true;\n    } catch {\n      result = false;\n    }\n    return result;\n  }\n\n  async createTempBrowserDir(baseDirName: string) {\n    return path.join(require('temp-dir'), baseDirName);\n  }\n\n  async launchAsync(\n    browserType: LaunchBrowserTypes,\n    args: string[]\n  ): Promise<LaunchBrowserInstance> {\n    const appId = await this.getAppId(browserType);\n    this._process = await open.openApp(appId, { arguments: args });\n    return this;\n  }\n\n  async close(): Promise<void> {\n    this._process?.kill();\n    this._process = undefined;\n    this._appId = undefined;\n  }\n}\n"],"mappings":";;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAI+B;AAAA;AAAA;AAAA;AAE/B;AACA;AACA;AACe,MAAMA,sBAAsB,CAAqD;EAAA;IAAA;IAAA;IAAA,6BAIxF;MACJ,CAACC,mCAAkB,CAACC,MAAM,GAAG,CAAC,eAAe,EAAE,sBAAsB,EAAE,UAAU,CAAC;MAClF,CAACD,mCAAkB,CAACE,IAAI,GAAG,CAAC,gBAAgB,EAAE,oBAAoB;IACpE,CAAC;EAAA;EAED;AACF;AACA;EACE,MAAcC,QAAQ,CAACC,WAA+B,EAAmB;IACvE,IAAI,IAAI,CAACC,MAAM,IAAI,IAAI,IAAI,CAAC,IAAI,CAACC,GAAG,CAACF,WAAW,CAAC,CAACG,QAAQ,CAAC,IAAI,CAACF,MAAM,CAAC,EAAE;MACvE,KAAK,MAAMG,KAAK,IAAI,IAAI,CAACF,GAAG,CAACF,WAAW,CAAC,EAAE;QACzC,IAAI;UACF,MAAM;YAAEK;UAAO,CAAC,GAAG,MAAM,IAAAC,qBAAU,EAAC,OAAO,EAAE,CAACF,KAAK,CAAC,EAAE;YAAEG,KAAK,EAAE;UAAS,CAAC,CAAC;UAC1E,IAAIF,MAAM,KAAK,CAAC,EAAE;YAChB,IAAI,CAACJ,MAAM,GAAGG,KAAK;YACnB;UACF;QACF,CAAC,CAAC,MAAM,CAAC;MACX;IACF;IAEA,IAAI,IAAI,CAACH,MAAM,IAAI,IAAI,EAAE;MACvB,MAAM,IAAIO,KAAK,CACZ,4CAA2C,IAAI,CAACN,GAAG,CAACF,WAAW,CAAC,CAACS,IAAI,CAAC,IAAI,CAAE,GAAE,CAChF;IACH;IAEA,OAAO,IAAI,CAACR,MAAM;EACpB;EAEA,MAAMS,kBAAkB,CAACV,WAA+B,EAAoB;IAC1E,IAAIW,MAAM,GAAG,KAAK;IAClB,IAAI;MACF,MAAM,IAAI,CAACZ,QAAQ,CAACC,WAAW,CAAC;MAChCW,MAAM,GAAG,IAAI;IACf,CAAC,CAAC,MAAM;MACNA,MAAM,GAAG,KAAK;IAChB;IACA,OAAOA,MAAM;EACf;EAEA,MAAMC,oBAAoB,CAACC,WAAmB,EAAE;IAC9C,OAAOC,eAAI,CAACL,IAAI,CAACM,OAAO,CAAC,UAAU,CAAC,EAAEF,WAAW,CAAC;EACpD;EAEA,MAAMG,WAAW,CACfhB,WAA+B,EAC/BiB,IAAc,EACkB;IAChC,MAAMb,KAAK,GAAG,MAAM,IAAI,CAACL,QAAQ,CAACC,WAAW,CAAC;IAC9C,IAAI,CAACkB,QAAQ,GAAG,MAAMC,eAAI,CAACC,OAAO,CAAChB,KAAK,EAAE;MAAEiB,SAAS,EAAEJ;IAAK,CAAC,CAAC;IAC9D,OAAO,IAAI;EACb;EAEA,MAAMK,KAAK,GAAkB;IAAA;IAC3B,sBAAI,CAACJ,QAAQ,mDAAb,eAAeK,IAAI,EAAE;IACrB,IAAI,CAACL,QAAQ,GAAGM,SAAS;IACzB,IAAI,CAACvB,MAAM,GAAGuB,SAAS;EACzB;AACF;AAAC"}