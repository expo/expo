{"version":3,"file":"HermesBundler.js","names":["_spawnAsync","data","_interopRequireDefault","require","_fsExtra","_os","_path","_process","_importMetroFromProject","obj","__esModule","default","isEnableHermesManaged","expoConfig","platform","_expoConfig$android$j","_expoConfig$android","android","jsEngine","_expoConfig$ios$jsEng","_expoConfig$ios","ios","buildHermesBundleAsync","projectRoot","code","map","optimize","tempDir","path","join","os","tmpdir","process","pid","fs","ensureDir","tempBundleFile","tempSourcemapFile","writeFile","tempHbcFile","hermesCommand","importHermesCommandFromProject","args","push","spawnAsync","hbc","sourcemap","Promise","all","readFile","createHermesSourcemapAsync","remove","hermesMapFile","composeSourceMaps","importMetroSourceMapComposeSourceMapsFromProject","bundlerSourcemap","JSON","parse","hermesSourcemap","readJSON","stringify","parseGradleProperties","content","result","line","split","trim","startsWith","sepIndex","indexOf","key","substr","value","maybeThrowFromInconsistentEngineAsync","configFilePath","isHermesManaged","configFileName","basename","maybeInconsistentEngineAndroidAsync","Error","maybeInconsistentEngineIosAsync","gradlePropertiesPath","existsSync","props","isHermesBare","podfilePath","isPropsReference","search","podfilePropertiesPath","parsePodfilePropertiesAsync","HERMES_MAGIC_HEADER","isHermesBytecodeBundleAsync","file","header","readHermesHeaderAsync","slice","toString","getHermesBytecodeBundleVersionAsync","readUInt32LE","fd","open","buffer","Buffer","alloc","read","close"],"sources":["../src/HermesBundler.ts"],"sourcesContent":["import type { ExpoConfig, Platform } from '@expo/config';\nimport spawnAsync from '@expo/spawn-async';\nimport fs from 'fs-extra';\nimport os from 'os';\nimport path from 'path';\nimport process from 'process';\n\nimport {\n  importHermesCommandFromProject,\n  importMetroSourceMapComposeSourceMapsFromProject,\n} from './metro/importMetroFromProject';\n\nexport function isEnableHermesManaged(expoConfig: ExpoConfig, platform: Platform): boolean {\n  switch (platform) {\n    case 'android': {\n      return (expoConfig.android?.jsEngine ?? expoConfig.jsEngine) !== 'jsc';\n    }\n    case 'ios': {\n      return (expoConfig.ios?.jsEngine ?? expoConfig.jsEngine) !== 'jsc';\n    }\n    default:\n      return false;\n  }\n}\n\ninterface HermesBundleOutput {\n  hbc: Uint8Array;\n  sourcemap: string;\n}\nexport async function buildHermesBundleAsync(\n  projectRoot: string,\n  code: string,\n  map: string,\n  optimize: boolean = false\n): Promise<HermesBundleOutput> {\n  const tempDir = path.join(os.tmpdir(), `expo-bundler-${process.pid}`);\n  await fs.ensureDir(tempDir);\n  try {\n    const tempBundleFile = path.join(tempDir, 'index.bundle');\n    const tempSourcemapFile = path.join(tempDir, 'index.bundle.map');\n    await fs.writeFile(tempBundleFile, code);\n    await fs.writeFile(tempSourcemapFile, map);\n\n    const tempHbcFile = path.join(tempDir, 'index.hbc');\n    const hermesCommand = importHermesCommandFromProject(projectRoot);\n    const args = ['-emit-binary', '-out', tempHbcFile, tempBundleFile, '-output-source-map'];\n    if (optimize) {\n      args.push('-O');\n    }\n    await spawnAsync(hermesCommand, args);\n\n    const [hbc, sourcemap] = await Promise.all([\n      fs.readFile(tempHbcFile),\n      createHermesSourcemapAsync(projectRoot, map, `${tempHbcFile}.map`),\n    ]);\n    return {\n      hbc,\n      sourcemap,\n    };\n  } finally {\n    await fs.remove(tempDir);\n  }\n}\n\nexport async function createHermesSourcemapAsync(\n  projectRoot: string,\n  sourcemap: string,\n  hermesMapFile: string\n): Promise<string> {\n  const composeSourceMaps = importMetroSourceMapComposeSourceMapsFromProject(projectRoot);\n  const bundlerSourcemap = JSON.parse(sourcemap);\n  const hermesSourcemap = await fs.readJSON(hermesMapFile);\n  return JSON.stringify(composeSourceMaps([bundlerSourcemap, hermesSourcemap]));\n}\n\nexport function parseGradleProperties(content: string): Record<string, string> {\n  const result: Record<string, string> = {};\n  for (let line of content.split('\\n')) {\n    line = line.trim();\n    if (!line || line.startsWith('#')) {\n      continue;\n    }\n\n    const sepIndex = line.indexOf('=');\n    const key = line.substr(0, sepIndex);\n    const value = line.substr(sepIndex + 1);\n    result[key] = value;\n  }\n  return result;\n}\n\nexport async function maybeThrowFromInconsistentEngineAsync(\n  projectRoot: string,\n  configFilePath: string,\n  platform: string,\n  isHermesManaged: boolean\n): Promise<void> {\n  const configFileName = path.basename(configFilePath);\n  if (\n    platform === 'android' &&\n    (await maybeInconsistentEngineAndroidAsync(projectRoot, isHermesManaged))\n  ) {\n    throw new Error(\n      `JavaScript engine configuration is inconsistent between ${configFileName} and Android native project.\\n` +\n        `In ${configFileName}: Hermes is ${isHermesManaged ? 'enabled' : 'not enabled'}\\n` +\n        `In Android native project: Hermes is ${isHermesManaged ? 'not enabled' : 'enabled'}\\n` +\n        `Please check the following files for inconsistencies:\\n` +\n        `  - ${configFilePath}\\n` +\n        `  - ${path.join(projectRoot, 'android', 'gradle.properties')}\\n` +\n        `  - ${path.join(projectRoot, 'android', 'app', 'build.gradle')}\\n` +\n        'Learn more: https://expo.fyi/hermes-android-config'\n    );\n  }\n\n  if (platform === 'ios' && (await maybeInconsistentEngineIosAsync(projectRoot, isHermesManaged))) {\n    throw new Error(\n      `JavaScript engine configuration is inconsistent between ${configFileName} and iOS native project.\\n` +\n        `In ${configFileName}: Hermes is ${isHermesManaged ? 'enabled' : 'not enabled'}\\n` +\n        `In iOS native project: Hermes is ${isHermesManaged ? 'not enabled' : 'enabled'}\\n` +\n        `Please check the following files for inconsistencies:\\n` +\n        `  - ${configFilePath}\\n` +\n        `  - ${path.join(projectRoot, 'ios', 'Podfile')}\\n` +\n        `  - ${path.join(projectRoot, 'ios', 'Podfile.properties.json')}\\n` +\n        'Learn more: https://expo.fyi/hermes-ios-config'\n    );\n  }\n}\n\nexport async function maybeInconsistentEngineAndroidAsync(\n  projectRoot: string,\n  isHermesManaged: boolean\n): Promise<boolean> {\n  // Trying best to check android native project if by chance to be consistent between app config\n\n  // Check gradle.properties from prebuild template\n  const gradlePropertiesPath = path.join(projectRoot, 'android', 'gradle.properties');\n  if (fs.existsSync(gradlePropertiesPath)) {\n    const props = parseGradleProperties(await fs.readFile(gradlePropertiesPath, 'utf8'));\n    const isHermesBare = props['hermesEnabled'] === 'true';\n    if (isHermesManaged !== isHermesBare) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport async function maybeInconsistentEngineIosAsync(\n  projectRoot: string,\n  isHermesManaged: boolean\n): Promise<boolean> {\n  // Trying best to check ios native project if by chance to be consistent between app config\n\n  // Check ios/Podfile for \":hermes_enabled => true\"\n  const podfilePath = path.join(projectRoot, 'ios', 'Podfile');\n  if (fs.existsSync(podfilePath)) {\n    const content = await fs.readFile(podfilePath, 'utf8');\n    const isPropsReference =\n      content.search(\n        /^\\s*:hermes_enabled\\s*=>\\s*podfile_properties\\['expo.jsEngine'\\]\\s*==\\s*nil\\s*\\|\\|\\s*podfile_properties\\['expo.jsEngine'\\]\\s*==\\s*'hermes',?/m\n      ) >= 0;\n    const isHermesBare = content.search(/^\\s*:hermes_enabled\\s*=>\\s*true,?\\s+/m) >= 0;\n    if (!isPropsReference && isHermesManaged !== isHermesBare) {\n      return true;\n    }\n  }\n\n  // Check Podfile.properties.json from prebuild template\n  const podfilePropertiesPath = path.join(projectRoot, 'ios', 'Podfile.properties.json');\n  if (fs.existsSync(podfilePropertiesPath)) {\n    const props = await parsePodfilePropertiesAsync(podfilePropertiesPath);\n    const isHermesBare = props['expo.jsEngine'] === 'hermes';\n    if (isHermesManaged !== isHermesBare) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// https://github.com/facebook/hermes/blob/release-v0.5/include/hermes/BCGen/HBC/BytecodeFileFormat.h#L24-L25\nconst HERMES_MAGIC_HEADER = 'c61fbc03c103191f';\n\nexport async function isHermesBytecodeBundleAsync(file: string): Promise<boolean> {\n  const header = await readHermesHeaderAsync(file);\n  return header.slice(0, 8).toString('hex') === HERMES_MAGIC_HEADER;\n}\n\nexport async function getHermesBytecodeBundleVersionAsync(file: string): Promise<number> {\n  const header = await readHermesHeaderAsync(file);\n  if (header.slice(0, 8).toString('hex') !== HERMES_MAGIC_HEADER) {\n    throw new Error('Invalid hermes bundle file');\n  }\n  return header.readUInt32LE(8);\n}\n\nasync function readHermesHeaderAsync(file: string): Promise<Buffer> {\n  const fd = await fs.open(file, 'r');\n  const buffer = Buffer.alloc(12);\n  await fs.read(fd, buffer, 0, 12, null);\n  await fs.close(fd);\n  return buffer;\n}\n\nasync function parsePodfilePropertiesAsync(\n  podfilePropertiesPath: string\n): Promise<Record<string, string>> {\n  try {\n    return JSON.parse(await fs.readFile(podfilePropertiesPath, 'utf8'));\n  } catch {\n    return {};\n  }\n}\n"],"mappings":"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"}