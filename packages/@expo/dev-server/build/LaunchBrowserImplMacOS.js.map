{"version":3,"file":"LaunchBrowserImplMacOS.js","names":["osascript","data","_interopRequireWildcard","require","_child_process","_glob","_path","_interopRequireDefault","_LaunchBrowser","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_defineProperty","value","_toPropertyKey","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","TypeError","Number","LaunchBrowserImplMacOS","constructor","LaunchBrowserTypes","CHROME","EDGE","isSupportedBrowser","browserType","result","execAsync","MAP","createTempBrowserDir","baseDirName","path","join","launchAsync","args","_globSync","appDirectory","appPath","globSync","cwd","trim","absolute","Error","_process","spawn","stdio","close","_this$_process","kill","exports"],"sources":["../src/LaunchBrowserImplMacOS.ts"],"sourcesContent":["import * as osascript from '@expo/osascript';\nimport { spawn, type ChildProcess } from 'child_process';\nimport { sync as globSync } from 'glob';\nimport path from 'path';\n\nimport {\n  LaunchBrowserTypes,\n  type LaunchBrowserImpl,\n  type LaunchBrowserInstance,\n} from './LaunchBrowser.types';\n\n/**\n * Browser implementation for macOS\n */\nexport default class LaunchBrowserImplMacOS implements LaunchBrowserImpl, LaunchBrowserInstance {\n  private _process: ChildProcess | undefined;\n\n  MAP = {\n    [LaunchBrowserTypes.CHROME]: 'google chrome',\n    [LaunchBrowserTypes.EDGE]: 'microsoft edge',\n  };\n\n  async isSupportedBrowser(browserType: LaunchBrowserTypes): Promise<boolean> {\n    let result = false;\n    try {\n      await osascript.execAsync(`id of application \"${this.MAP[browserType]}\"`);\n      result = true;\n    } catch {\n      result = false;\n    }\n    return result;\n  }\n\n  async createTempBrowserDir(baseDirName: string) {\n    return path.join(require('temp-dir'), baseDirName);\n  }\n\n  async launchAsync(\n    browserType: LaunchBrowserTypes,\n    args: string[]\n  ): Promise<LaunchBrowserInstance> {\n    const appDirectory = await osascript.execAsync(\n      `POSIX path of (path to application \"${this.MAP[browserType]}\")`\n    );\n    const appPath = globSync('Contents/MacOS/*', { cwd: appDirectory.trim(), absolute: true })?.[0];\n    if (!appPath) {\n      throw new Error(`Cannot find application path from ${appDirectory}Contents/MacOS`);\n    }\n    this._process = spawn(appPath, args, { stdio: 'ignore' });\n\n    return this;\n  }\n\n  async close(): Promise<void> {\n    this._process?.kill();\n    this._process = undefined;\n  }\n}\n"],"mappings":"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"}