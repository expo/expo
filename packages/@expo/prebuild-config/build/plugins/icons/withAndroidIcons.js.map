{"version":3,"file":"withAndroidIcons.js","names":["_configPlugins","data","require","_imageUtils","_fsExtra","_interopRequireDefault","_path","_withAndroidManifestIcons","e","__esModule","default","Colors","AndroidConfig","dpiValues","exports","mdpi","folderName","scale","hdpi","xhdpi","xxhdpi","xxxhdpi","ICON_BASELINE_PIXEL_SIZE","FOREGROUND_BASELINE_PIXEL_SIZE","ANDROID_RES_PATH","MIPMAP_ANYDPI_V26","ICON_BACKGROUND","IC_LAUNCHER_WEBP","IC_LAUNCHER_ROUND_WEBP","IC_LAUNCHER_BACKGROUND_WEBP","IC_LAUNCHER_FOREGROUND_WEBP","IC_LAUNCHER_MONOCHROME_WEBP","IC_LAUNCHER_XML","IC_LAUNCHER_ROUND_XML","withAndroidIcons","config","foregroundImage","backgroundColor","backgroundImage","monochromeImage","getAdaptiveIcon","icon","getIcon","withAndroidManifestIcons","withAndroidAdaptiveIconColors","withDangerousMod","setIconAsync","modRequest","projectRoot","isAdaptive","android","adaptiveIcon","setRoundIconManifest","manifest","application","Manifest","getMainApplicationOrThrow","$","withAndroidColors","modResults","setBackgroundColor","configureLegacyIconAsync","generateRoundIconAsync","deleteIconNamedAsync","configureAdaptiveIconAsync","generateMultiLayerImageAsync","outputImageFileName","imageCacheFolder","backgroundImageCacheFolder","borderRadiusRatio","generateMonochromeImageAsync","backgroundImageFileName","icLauncherXmlString","createAdaptiveIconXmlString","createAdaptiveIconXmlFiles","colors","assignColorValue","value","name","background","iconElements","push","join","add","anyDpiV26Directory","path","resolve","fs","ensureDir","launcherPath","launcherRoundPath","Promise","all","writeFile","map","existsSync","remove","iterateDpiValues","dpiFolder","iconLayer","generateIconAsync","cacheType","src","imageStlye","getImageStyle","backgroundLayer","compositeImagesAsync","foreground","monochromeIcon","callback","Object","values","isForegound","baseline","bgIconSizePx","Math","round","iconSizePx","getImageScale","source","generateImageAsync","resizeMode","width","height","generateImageBackgroundAsync","borderRadius","undefined","x","y","outputFileName","imageStyle"],"sources":["../../../src/plugins/icons/withAndroidIcons.ts"],"sourcesContent":["import {\n  AndroidConfig,\n  ConfigPlugin,\n  withAndroidColors,\n  withDangerousMod,\n} from '@expo/config-plugins';\nimport { ResourceXML } from '@expo/config-plugins/build/android/Resources';\nimport { ExpoConfig } from '@expo/config-types';\nimport {\n  generateImageAsync,\n  compositeImagesAsync,\n  generateImageBackgroundAsync,\n} from '@expo/image-utils';\nimport fs from 'fs-extra';\nimport path from 'path';\n\nimport { withAndroidManifestIcons } from './withAndroidManifestIcons';\n\nconst { Colors } = AndroidConfig;\n\ntype DPIString = 'mdpi' | 'hdpi' | 'xhdpi' | 'xxhdpi' | 'xxxhdpi';\ntype dpiMap = Record<DPIString, { folderName: string; scale: number }>;\ntype ImageStyle = 'foreground' | 'background' | 'rounded' | 'monochrome' | 'legacy';\n\nexport const dpiValues: dpiMap = {\n  mdpi: { folderName: 'mipmap-mdpi', scale: 1 },\n  hdpi: { folderName: 'mipmap-hdpi', scale: 1.5 },\n  xhdpi: { folderName: 'mipmap-xhdpi', scale: 2 },\n  xxhdpi: { folderName: 'mipmap-xxhdpi', scale: 3 },\n  xxxhdpi: { folderName: 'mipmap-xxxhdpi', scale: 4 },\n};\nconst ICON_BASELINE_PIXEL_SIZE = 48;\nconst FOREGROUND_BASELINE_PIXEL_SIZE = 108;\n\nexport const ANDROID_RES_PATH = 'android/app/src/main/res/';\nconst MIPMAP_ANYDPI_V26 = 'mipmap-anydpi-v26';\nconst ICON_BACKGROUND = 'iconBackground';\nconst IC_LAUNCHER_WEBP = 'ic_launcher.webp';\nconst IC_LAUNCHER_ROUND_WEBP = 'ic_launcher_round.webp';\nconst IC_LAUNCHER_BACKGROUND_WEBP = 'ic_launcher_background.webp';\nconst IC_LAUNCHER_FOREGROUND_WEBP = 'ic_launcher_foreground.webp';\nconst IC_LAUNCHER_MONOCHROME_WEBP = 'ic_launcher_monochrome.webp';\nconst IC_LAUNCHER_XML = 'ic_launcher.xml';\nconst IC_LAUNCHER_ROUND_XML = 'ic_launcher_round.xml';\n\nexport const withAndroidIcons: ConfigPlugin = (config) => {\n  const { foregroundImage, backgroundColor, backgroundImage, monochromeImage } =\n    getAdaptiveIcon(config);\n  const icon = foregroundImage ?? getIcon(config);\n\n  if (!icon) {\n    return config;\n  }\n\n  config = withAndroidManifestIcons(config);\n  // Apply colors.xml changes\n  config = withAndroidAdaptiveIconColors(config, backgroundColor);\n  return withDangerousMod(config, [\n    'android',\n    async (config) => {\n      await setIconAsync(config.modRequest.projectRoot, {\n        icon,\n        backgroundColor,\n        backgroundImage,\n        monochromeImage,\n        isAdaptive: !!config.android?.adaptiveIcon,\n      });\n      return config;\n    },\n  ]);\n};\n\nexport function setRoundIconManifest(\n  config: Pick<ExpoConfig, 'android'>,\n  manifest: AndroidConfig.Manifest.AndroidManifest\n): AndroidConfig.Manifest.AndroidManifest {\n  const isAdaptive = !!config.android?.adaptiveIcon;\n  const application = AndroidConfig.Manifest.getMainApplicationOrThrow(manifest);\n\n  if (isAdaptive) {\n    application.$['android:roundIcon'] = '@mipmap/ic_launcher_round';\n  } else {\n    delete application.$['android:roundIcon'];\n  }\n  return manifest;\n}\n\nconst withAndroidAdaptiveIconColors: ConfigPlugin<string | null> = (config, backgroundColor) => {\n  return withAndroidColors(config, (config) => {\n    config.modResults = setBackgroundColor(backgroundColor ?? '#ffffff', config.modResults);\n    return config;\n  });\n};\n\nexport function getIcon(config: ExpoConfig) {\n  return config.android?.icon || config.icon || null;\n}\n\nexport function getAdaptiveIcon(config: ExpoConfig) {\n  return {\n    foregroundImage: config.android?.adaptiveIcon?.foregroundImage ?? null,\n    backgroundColor: config.android?.adaptiveIcon?.backgroundColor ?? null,\n    backgroundImage: config.android?.adaptiveIcon?.backgroundImage ?? null,\n    monochromeImage: config.android?.adaptiveIcon?.monochromeImage ?? null,\n  };\n}\n\n/**\n * Resizes the user-provided icon to create a set of legacy icon files in\n * their respective \"mipmap\" directories for <= Android 7, and creates a set of adaptive\n * icon files for > Android 7 from the adaptive icon files (if provided).\n */\nexport async function setIconAsync(\n  projectRoot: string,\n  {\n    icon,\n    backgroundColor,\n    backgroundImage,\n    monochromeImage,\n    isAdaptive,\n  }: {\n    icon: string | null;\n    backgroundColor: string | null;\n    backgroundImage: string | null;\n    monochromeImage: string | null;\n    isAdaptive: boolean;\n  }\n) {\n  if (!icon) {\n    return null;\n  }\n\n  await configureLegacyIconAsync(projectRoot, icon, backgroundImage, backgroundColor);\n  if (isAdaptive) {\n    await generateRoundIconAsync(projectRoot, icon, backgroundImage, backgroundColor);\n  } else {\n    await deleteIconNamedAsync(projectRoot, IC_LAUNCHER_ROUND_WEBP);\n  }\n  await configureAdaptiveIconAsync(\n    projectRoot,\n    icon,\n    backgroundImage,\n    backgroundColor,\n    monochromeImage,\n    isAdaptive\n  );\n\n  return true;\n}\n\n/**\n * Configures legacy icon files to be used on Android 7 and earlier. If adaptive icon configuration\n * was provided, we create a pseudo-adaptive icon by layering the provided files (or background\n * color if no backgroundImage is provided. If no backgroundImage and no backgroundColor are provided,\n * the background is set to transparent.)\n */\nasync function configureLegacyIconAsync(\n  projectRoot: string,\n  icon: string,\n  backgroundImage: string | null,\n  backgroundColor: string | null\n) {\n  return generateMultiLayerImageAsync(projectRoot, {\n    icon,\n    backgroundImage,\n    backgroundColor,\n    outputImageFileName: IC_LAUNCHER_WEBP,\n    imageCacheFolder: 'android-standard-square',\n    backgroundImageCacheFolder: 'android-standard-square-background',\n  });\n}\n\nasync function generateRoundIconAsync(\n  projectRoot: string,\n  icon: string,\n  backgroundImage: string | null,\n  backgroundColor: string | null\n) {\n  return generateMultiLayerImageAsync(projectRoot, {\n    icon,\n    borderRadiusRatio: 0.5,\n    outputImageFileName: IC_LAUNCHER_ROUND_WEBP,\n    backgroundImage,\n    backgroundColor,\n    imageCacheFolder: 'android-standard-circle',\n    backgroundImageCacheFolder: 'android-standard-round-background',\n  });\n}\n\n/**\n * Configures adaptive icon files to be used on Android 8 and up. A foreground image must be provided,\n * and will have a transparent background unless:\n * - A backgroundImage is provided, or\n * - A backgroundColor was specified\n */\nexport async function configureAdaptiveIconAsync(\n  projectRoot: string,\n  foregroundImage: string,\n  backgroundImage: string | null,\n  backgroundColor: string | null,\n  monochromeImage: string | null,\n  isAdaptive: boolean\n) {\n  if (monochromeImage) {\n    await generateMonochromeImageAsync(projectRoot, {\n      icon: monochromeImage,\n      imageCacheFolder: 'android-adaptive-monochrome',\n      outputImageFileName: IC_LAUNCHER_MONOCHROME_WEBP,\n    });\n  }\n  await generateMultiLayerImageAsync(projectRoot, {\n    backgroundColor,\n    backgroundImage,\n    backgroundImageCacheFolder: 'android-adaptive-background',\n    outputImageFileName: IC_LAUNCHER_FOREGROUND_WEBP,\n    icon: foregroundImage,\n    imageCacheFolder: 'android-adaptive-foreground',\n    backgroundImageFileName: IC_LAUNCHER_BACKGROUND_WEBP,\n  });\n\n  // create ic_launcher.xml and ic_launcher_round.xml\n  const icLauncherXmlString = createAdaptiveIconXmlString(backgroundImage, monochromeImage);\n  await createAdaptiveIconXmlFiles(\n    projectRoot,\n    icLauncherXmlString,\n    // If the user only defined icon and not android.adaptiveIcon, then skip enabling the layering system\n    // this will scale the image down and present it uncropped.\n    isAdaptive\n  );\n}\n\nfunction setBackgroundColor(backgroundColor: string | null, colors: ResourceXML) {\n  return Colors.assignColorValue(colors, {\n    value: backgroundColor,\n    name: ICON_BACKGROUND,\n  });\n}\n\nexport const createAdaptiveIconXmlString = (\n  backgroundImage: string | null,\n  monochromeImage: string | null\n) => {\n  const background = backgroundImage ? `@drawable/ic_launcher_background` : `@color/iconBackground`;\n\n  const iconElements: string[] = [\n    `<background android:drawable=\"${background}\"/>`,\n    '<foreground android:drawable=\"@mipmap/ic_launcher_foreground\"/>',\n  ];\n\n  if (monochromeImage) {\n    iconElements.push('<monochrome android:drawable=\"@mipmap/ic_launcher_monochrome\"/>');\n  }\n\n  return `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<adaptive-icon xmlns:android=\"http://schemas.android.com/apk/res/android\">\n    ${iconElements.join('\\n    ')}\n</adaptive-icon>`;\n};\n\nasync function createAdaptiveIconXmlFiles(\n  projectRoot: string,\n  icLauncherXmlString: string,\n  add: boolean\n) {\n  const anyDpiV26Directory = path.resolve(projectRoot, ANDROID_RES_PATH, MIPMAP_ANYDPI_V26);\n  await fs.ensureDir(anyDpiV26Directory);\n  const launcherPath = path.resolve(anyDpiV26Directory, IC_LAUNCHER_XML);\n  const launcherRoundPath = path.resolve(anyDpiV26Directory, IC_LAUNCHER_ROUND_XML);\n  if (add) {\n    await Promise.all([\n      fs.writeFile(launcherPath, icLauncherXmlString),\n      fs.writeFile(launcherRoundPath, icLauncherXmlString),\n    ]);\n  } else {\n    // Remove the xml if the icon switches from adaptive to standard.\n    await Promise.all(\n      [launcherPath, launcherRoundPath].map(async (path) => {\n        if (fs.existsSync(path)) {\n          return fs.remove(path);\n        }\n      })\n    );\n  }\n}\n\nasync function generateMultiLayerImageAsync(\n  projectRoot: string,\n  {\n    icon,\n    backgroundColor,\n    backgroundImage,\n    imageCacheFolder,\n    backgroundImageCacheFolder,\n    borderRadiusRatio,\n    outputImageFileName,\n    backgroundImageFileName,\n  }: {\n    icon: string;\n    backgroundImage: string | null;\n    backgroundColor: string | null;\n    imageCacheFolder: string;\n    backgroundImageCacheFolder: string;\n    backgroundImageFileName?: string;\n    borderRadiusRatio?: number;\n    outputImageFileName: string;\n  }\n) {\n  await iterateDpiValues(projectRoot, async ({ dpiFolder, scale }) => {\n    let iconLayer = await generateIconAsync(projectRoot, {\n      cacheType: imageCacheFolder,\n      src: icon,\n      scale,\n      backgroundColor: backgroundColor ?? 'transparent',\n      borderRadiusRatio,\n      imageStlye: getImageStyle(outputImageFileName),\n    });\n\n    if (backgroundImage) {\n      const backgroundLayer = await generateIconAsync(projectRoot, {\n        cacheType: backgroundImageCacheFolder,\n        src: backgroundImage,\n        scale,\n        backgroundColor: backgroundColor ?? 'transparent',\n        borderRadiusRatio,\n      });\n\n      if (backgroundImageFileName) {\n        await fs.writeFile(path.resolve(dpiFolder, backgroundImageFileName), backgroundLayer);\n      } else {\n        iconLayer = await compositeImagesAsync({\n          foreground: iconLayer,\n          background: backgroundLayer,\n        });\n      }\n    } else if (backgroundImageFileName) {\n      // Remove any instances of ic_launcher_background.png that are there from previous icons\n      await deleteIconNamedAsync(projectRoot, backgroundImageFileName);\n    }\n\n    await fs.ensureDir(dpiFolder);\n    await fs.writeFile(path.resolve(dpiFolder, outputImageFileName), iconLayer);\n  });\n}\n\nasync function generateMonochromeImageAsync(\n  projectRoot: string,\n  {\n    icon,\n    imageCacheFolder,\n    outputImageFileName,\n  }: { icon: string; imageCacheFolder: string; outputImageFileName: string }\n) {\n  await iterateDpiValues(projectRoot, async ({ dpiFolder, scale }) => {\n    const monochromeIcon = await generateIconAsync(projectRoot, {\n      cacheType: imageCacheFolder,\n      src: icon,\n      scale,\n      backgroundColor: 'transparent',\n    });\n    await fs.ensureDir(dpiFolder);\n    await fs.writeFile(path.resolve(dpiFolder, outputImageFileName), monochromeIcon);\n  });\n}\n\nfunction iterateDpiValues(\n  projectRoot: string,\n  callback: (value: { dpiFolder: string; folderName: string; scale: number }) => Promise<void>\n) {\n  return Promise.all(\n    Object.values(dpiValues).map((value) =>\n      callback({\n        dpiFolder: path.resolve(projectRoot, ANDROID_RES_PATH, value.folderName),\n        ...value,\n      })\n    )\n  );\n}\n\nasync function deleteIconNamedAsync(projectRoot: string, name: string) {\n  return iterateDpiValues(projectRoot, ({ dpiFolder }) => {\n    return fs.remove(path.resolve(dpiFolder, name));\n  });\n}\n\nasync function generateIconAsync(\n  projectRoot: string,\n  {\n    cacheType,\n    src,\n    scale,\n    backgroundColor,\n    borderRadiusRatio,\n    imageStlye,\n  }: {\n    cacheType: string;\n    src: string;\n    scale: number;\n    backgroundColor: string;\n    borderRadiusRatio?: number;\n    imageStlye?: ImageStyle;\n  }\n) {\n  const isForegound = imageStlye === 'foreground';\n  const baseline = isForegound ? FOREGROUND_BASELINE_PIXEL_SIZE : ICON_BASELINE_PIXEL_SIZE;\n  const bgIconSizePx = Math.round(baseline * scale);\n  const iconSizePx = Math.round(bgIconSizePx * getImageScale(imageStlye ?? 'background'));\n\n  const { source: foreground } = await generateImageAsync(\n    { projectRoot, cacheType },\n    {\n      src,\n      resizeMode: 'cover',\n      width: iconSizePx,\n      height: iconSizePx,\n    }\n  );\n\n  const background = await generateImageBackgroundAsync({\n    width: bgIconSizePx,\n    height: bgIconSizePx,\n    backgroundColor: isForegound ? 'transparent' : backgroundColor,\n    resizeMode: 'cover',\n    borderRadius: borderRadiusRatio ? bgIconSizePx * borderRadiusRatio : undefined,\n  });\n\n  const x = Math.round((bgIconSizePx - iconSizePx) / 2);\n  const y = x;\n\n  return compositeImagesAsync({ background, foreground, x, y });\n}\n\nfunction getImageStyle(outputFileName: string): ImageStyle {\n  switch (outputFileName) {\n    case IC_LAUNCHER_WEBP:\n      return 'legacy';\n    case IC_LAUNCHER_BACKGROUND_WEBP:\n      return 'background';\n    case IC_LAUNCHER_FOREGROUND_WEBP:\n      return 'foreground';\n    case IC_LAUNCHER_ROUND_WEBP:\n      return 'rounded';\n    case IC_LAUNCHER_MONOCHROME_WEBP:\n      return 'monochrome';\n  }\n\n  return 'background';\n}\n\nfunction getImageScale(imageStyle: ImageStyle) {\n  switch (imageStyle) {\n    case 'legacy':\n    case 'rounded':\n      return 0.9;\n    case 'foreground':\n    case 'background':\n      return 0.7;\n    case 'monochrome':\n      return 1;\n  }\n}\n"],"mappings":"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","ignoreList":[]}