{"version":3,"file":"withAndroidBranch.js","names":["_configPlugins","data","require","addMetaDataItemToMainApplication","getMainApplicationOrThrow","removeMetaDataItemFromMainApplication","AndroidConfig","Manifest","META_BRANCH_KEY","withAndroidBranch","config","withAndroidManifest","modResults","setBranchApiKey","exports","getBranchApiKey","_config$android$confi","_config$android","_config$android$confi2","_config$android$confi3","android","branch","apiKey","androidManifest","mainApplication"],"sources":["../../../../src/plugins/unversioned/expo-branch/withAndroidBranch.ts"],"sourcesContent":["import { AndroidConfig, ConfigPlugin, withAndroidManifest } from '@expo/config-plugins';\nimport { ExpoConfig } from '@expo/config-types';\n\nconst {\n  addMetaDataItemToMainApplication,\n  getMainApplicationOrThrow,\n  removeMetaDataItemFromMainApplication,\n} = AndroidConfig.Manifest;\n\nconst META_BRANCH_KEY = 'io.branch.sdk.BranchKey';\n\nexport const withAndroidBranch: ConfigPlugin = (config) => {\n  return withAndroidManifest(config, (config) => {\n    config.modResults = setBranchApiKey(config, config.modResults);\n    return config;\n  });\n};\n\nexport function getBranchApiKey(config: ExpoConfig) {\n  return config.android?.config?.branch?.apiKey ?? null;\n}\n\nexport function setBranchApiKey(\n  config: ExpoConfig,\n  androidManifest: AndroidConfig.Manifest.AndroidManifest\n) {\n  const apiKey = getBranchApiKey(config);\n\n  const mainApplication = getMainApplicationOrThrow(androidManifest);\n\n  if (apiKey) {\n    // If the item exists, add it back\n    addMetaDataItemToMainApplication(mainApplication, META_BRANCH_KEY, apiKey);\n  } else {\n    // Remove any existing item\n    removeMetaDataItemFromMainApplication(mainApplication, META_BRANCH_KEY);\n  }\n  return androidManifest;\n}\n"],"mappings":";;;;;;;;AAAA,SAAAA,eAAA;EAAA,MAAAC,IAAA,GAAAC,OAAA;EAAAF,cAAA,YAAAA,CAAA;IAAA,OAAAC,IAAA;EAAA;EAAA,OAAAA,IAAA;AAAA;AAGA,MAAM;EACJE,gCAAgC;EAChCC,yBAAyB;EACzBC;AACF,CAAC,GAAGC,8BAAa,CAACC,QAAQ;AAE1B,MAAMC,eAAe,GAAG,yBAAyB;AAE1C,MAAMC,iBAA+B,GAAIC,MAAM,IAAK;EACzD,OAAO,IAAAC,oCAAmB,EAACD,MAAM,EAAGA,MAAM,IAAK;IAC7CA,MAAM,CAACE,UAAU,GAAGC,eAAe,CAACH,MAAM,EAAEA,MAAM,CAACE,UAAU,CAAC;IAC9D,OAAOF,MAAM;EACf,CAAC,CAAC;AACJ,CAAC;AAACI,OAAA,CAAAL,iBAAA,GAAAA,iBAAA;AAEK,SAASM,eAAeA,CAACL,MAAkB,EAAE;EAAA,IAAAM,qBAAA,EAAAC,eAAA,EAAAC,sBAAA,EAAAC,sBAAA;EAClD,QAAAH,qBAAA,IAAAC,eAAA,GAAOP,MAAM,CAACU,OAAO,cAAAH,eAAA,wBAAAC,sBAAA,GAAdD,eAAA,CAAgBP,MAAM,cAAAQ,sBAAA,wBAAAC,sBAAA,GAAtBD,sBAAA,CAAwBG,MAAM,cAAAF,sBAAA,uBAA9BA,sBAAA,CAAgCG,MAAM,cAAAN,qBAAA,cAAAA,qBAAA,GAAI,IAAI;AACvD;AAEO,SAASH,eAAeA,CAC7BH,MAAkB,EAClBa,eAAuD,EACvD;EACA,MAAMD,MAAM,GAAGP,eAAe,CAACL,MAAM,CAAC;EAEtC,MAAMc,eAAe,GAAGpB,yBAAyB,CAACmB,eAAe,CAAC;EAElE,IAAID,MAAM,EAAE;IACV;IACAnB,gCAAgC,CAACqB,eAAe,EAAEhB,eAAe,EAAEc,MAAM,CAAC;EAC5E,CAAC,MAAM;IACL;IACAjB,qCAAqC,CAACmB,eAAe,EAAEhB,eAAe,CAAC;EACzE;EACA,OAAOe,eAAe;AACxB"}