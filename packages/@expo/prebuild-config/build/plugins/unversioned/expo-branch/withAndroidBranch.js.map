{"version":3,"file":"withAndroidBranch.js","names":["addMetaDataItemToMainApplication","getMainApplicationOrThrow","removeMetaDataItemFromMainApplication","AndroidConfig","Manifest","META_BRANCH_KEY","withAndroidBranch","config","withAndroidManifest","modResults","setBranchApiKey","getBranchApiKey","android","branch","apiKey","androidManifest","mainApplication"],"sources":["../../../../src/plugins/unversioned/expo-branch/withAndroidBranch.ts"],"sourcesContent":["import { AndroidConfig, ConfigPlugin, withAndroidManifest } from '@expo/config-plugins';\nimport { ExpoConfig } from '@expo/config-types';\n\nconst {\n  addMetaDataItemToMainApplication,\n  getMainApplicationOrThrow,\n  removeMetaDataItemFromMainApplication,\n} = AndroidConfig.Manifest;\n\nconst META_BRANCH_KEY = 'io.branch.sdk.BranchKey';\n\nexport const withAndroidBranch: ConfigPlugin = (config) => {\n  return withAndroidManifest(config, (config) => {\n    config.modResults = setBranchApiKey(config, config.modResults);\n    return config;\n  });\n};\n\nexport function getBranchApiKey(config: ExpoConfig) {\n  return config.android?.config?.branch?.apiKey ?? null;\n}\n\nexport function setBranchApiKey(\n  config: ExpoConfig,\n  androidManifest: AndroidConfig.Manifest.AndroidManifest\n) {\n  const apiKey = getBranchApiKey(config);\n\n  const mainApplication = getMainApplicationOrThrow(androidManifest);\n\n  if (apiKey) {\n    // If the item exists, add it back\n    addMetaDataItemToMainApplication(mainApplication, META_BRANCH_KEY, apiKey);\n  } else {\n    // Remove any existing item\n    removeMetaDataItemFromMainApplication(mainApplication, META_BRANCH_KEY);\n  }\n  return androidManifest;\n}\n"],"mappings":";;;;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAGA,MAAM;EACJA,gCAAgC;EAChCC,yBAAyB;EACzBC;AACF,CAAC,GAAGC,8BAAa,CAACC,QAAQ;AAE1B,MAAMC,eAAe,GAAG,yBAAyB;AAE1C,MAAMC,iBAA+B,GAAIC,MAAM,IAAK;EACzD,OAAO,IAAAC,oCAAmB,EAACD,MAAM,EAAGA,MAAM,IAAK;IAC7CA,MAAM,CAACE,UAAU,GAAGC,eAAe,CAACH,MAAM,EAAEA,MAAM,CAACE,UAAU,CAAC;IAC9D,OAAOF,MAAM;EACf,CAAC,CAAC;AACJ,CAAC;AAAC;AAEK,SAASI,eAAe,CAACJ,MAAkB,EAAE;EAAA;EAClD,mDAAOA,MAAM,CAACK,OAAO,8EAAd,gBAAgBL,MAAM,qFAAtB,uBAAwBM,MAAM,2DAA9B,uBAAgCC,MAAM,yEAAI,IAAI;AACvD;AAEO,SAASJ,eAAe,CAC7BH,MAAkB,EAClBQ,eAAuD,EACvD;EACA,MAAMD,MAAM,GAAGH,eAAe,CAACJ,MAAM,CAAC;EAEtC,MAAMS,eAAe,GAAGf,yBAAyB,CAACc,eAAe,CAAC;EAElE,IAAID,MAAM,EAAE;IACV;IACAd,gCAAgC,CAACgB,eAAe,EAAEX,eAAe,EAAES,MAAM,CAAC;EAC5E,CAAC,MAAM;IACL;IACAZ,qCAAqC,CAACc,eAAe,EAAEX,eAAe,CAAC;EACzE;EACA,OAAOU,eAAe;AACxB"}