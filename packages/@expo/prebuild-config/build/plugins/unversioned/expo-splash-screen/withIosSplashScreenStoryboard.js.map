{"version":3,"file":"withIosSplashScreenStoryboard.js","names":["STORYBOARD_FILE_PATH","STORYBOARD_MOD_NAME","withIosSplashScreenStoryboard","config","action","withMod","platform","mod","withIosSplashScreenStoryboardBaseMod","BaseMods","withGeneratedBaseMods","saveToInternal","skipEmptyMod","providers","provider","isIntrospective","getFilePath","modRequest","path","join","platformProjectRoot","projectName","read","filePath","contents","fs","promises","readFile","xml","Parser","parseStringPromise","getTemplateAsync","write","modResults","introspect","writeFile","toString"],"sources":["../../../../src/plugins/unversioned/expo-splash-screen/withIosSplashScreenStoryboard.ts"],"sourcesContent":["import { BaseMods, ConfigPlugin, Mod, withMod } from '@expo/config-plugins';\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport { Parser } from 'xml2js';\n\nimport { IBSplashScreenDocument, toString } from './InterfaceBuilder';\n\nexport const STORYBOARD_FILE_PATH = './SplashScreen.storyboard';\n\nconst STORYBOARD_MOD_NAME = 'splashScreenStoryboard';\n\n/**\n * Provides the SplashScreen `.storyboard` xml data for modification.\n *\n * @param config\n * @param action\n */\nexport const withIosSplashScreenStoryboard: ConfigPlugin<Mod<IBSplashScreenDocument>> = (\n  config,\n  action\n) => {\n  return withMod(config, {\n    platform: 'ios',\n    mod: STORYBOARD_MOD_NAME,\n    action,\n  });\n};\n\n/** Append a custom rule to supply SplashScreen `.storyboard` xml data to mods on `mods.ios.splashScreenStoryboard` */\nexport const withIosSplashScreenStoryboardBaseMod: ConfigPlugin = (config) => {\n  return BaseMods.withGeneratedBaseMods(config, {\n    platform: 'ios',\n    saveToInternal: true,\n    skipEmptyMod: false,\n    providers: {\n      // Append a custom rule to supply .storyboard xml data to mods on `mods.ios.splashScreenStoryboard`\n      [STORYBOARD_MOD_NAME]: BaseMods.provider<IBSplashScreenDocument>({\n        isIntrospective: true,\n        async getFilePath({ modRequest }) {\n          //: [root]/myapp/ios/MyApp/SplashScreen.storyboard\n          return path.join(\n            //: myapp/ios\n            modRequest.platformProjectRoot,\n            // ./MyApp\n            modRequest.projectName!,\n            // ./SplashScreen.storyboard\n            STORYBOARD_FILE_PATH\n          );\n        },\n        async read(filePath) {\n          try {\n            const contents = await fs.promises.readFile(filePath, 'utf8');\n            const xml = await new Parser().parseStringPromise(contents);\n            return xml;\n          } catch {\n            return getTemplateAsync();\n          }\n        },\n        async write(filePath, { modResults, modRequest: { introspect } }) {\n          if (introspect) {\n            return;\n          }\n          await fs.promises.writeFile(filePath, toString(modResults));\n        },\n      }),\n    },\n  });\n};\n\n/** Get a template splash screen storyboard file. */\nexport async function getTemplateAsync(): Promise<IBSplashScreenDocument> {\n  const contents = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n    <document\n      type=\"com.apple.InterfaceBuilder3.CocoaTouch.Storyboard.XIB\"\n      version=\"3.0\"\n      toolsVersion=\"16096\"\n      targetRuntime=\"iOS.CocoaTouch\"\n      propertyAccessControl=\"none\"\n      useAutolayout=\"YES\"\n      launchScreen=\"YES\"\n      useTraitCollections=\"YES\"\n      useSafeAreas=\"YES\"\n      colorMatched=\"YES\"\n      initialViewController=\"EXPO-VIEWCONTROLLER-1\"\n    >\n      <dependencies>\n        <deployment identifier=\"iOS\"/>\n        <plugIn identifier=\"com.apple.InterfaceBuilder.IBCocoaTouchPlugin\" version=\"16087\"/>\n        <capability name=\"Safe area layout guides\" minToolsVersion=\"9.0\"/>\n        <capability name=\"documents saved in the Xcode 8 format\" minToolsVersion=\"8.0\"/>\n      </dependencies>\n      <scenes>\n        <scene sceneID=\"EXPO-SCENE-1\">\n          <objects>\n            <viewController\n              storyboardIdentifier=\"SplashScreenViewController\"\n              id=\"EXPO-VIEWCONTROLLER-1\"\n              sceneMemberID=\"viewController\"\n            >\n              <view\n                key=\"view\"\n                userInteractionEnabled=\"NO\"\n                contentMode=\"scaleToFill\"\n                insetsLayoutMarginsFromSafeArea=\"NO\"\n                id=\"EXPO-ContainerView\"\n                userLabel=\"ContainerView\"\n              >\n                <rect key=\"frame\" x=\"0.0\" y=\"0.0\" width=\"414\" height=\"736\"/>\n                <autoresizingMask key=\"autoresizingMask\" flexibleMaxX=\"YES\" flexibleMaxY=\"YES\"/>\n                <subviews>\n                  <imageView\n                    userInteractionEnabled=\"NO\"\n                    contentMode=\"scaleAspectFill\"\n                    horizontalHuggingPriority=\"251\"\n                    verticalHuggingPriority=\"251\"\n                    insetsLayoutMarginsFromSafeArea=\"NO\"\n                    image=\"SplashScreenBackground\"\n                    translatesAutoresizingMaskIntoConstraints=\"NO\"\n                    id=\"EXPO-SplashScreenBackground\"\n                    userLabel=\"SplashScreenBackground\"\n                  >\n                    <rect key=\"frame\" x=\"0.0\" y=\"0.0\" width=\"414\" height=\"736\"/>\n                  </imageView>\n                </subviews>\n                <color key=\"backgroundColor\" systemColor=\"systemBackgroundColor\"/>\n                <constraints>\n                  <constraint firstItem=\"EXPO-SplashScreenBackground\" firstAttribute=\"top\" secondItem=\"EXPO-ContainerView\" secondAttribute=\"top\" id=\"1gX-mQ-vu6\"/>\n                  <constraint firstItem=\"EXPO-SplashScreenBackground\" firstAttribute=\"leading\" secondItem=\"EXPO-ContainerView\" secondAttribute=\"leading\" id=\"6tX-OG-Sck\"/>\n                  <constraint firstItem=\"EXPO-SplashScreenBackground\" firstAttribute=\"trailing\" secondItem=\"EXPO-ContainerView\" secondAttribute=\"trailing\" id=\"ABX-8g-7v4\"/>\n                  <constraint firstItem=\"EXPO-SplashScreenBackground\" firstAttribute=\"bottom\" secondItem=\"EXPO-ContainerView\" secondAttribute=\"bottom\" id=\"jkI-2V-eW5\"/>\n                </constraints>\n                <viewLayoutGuide key=\"safeArea\" id=\"EXPO-SafeArea\"/>\n              </view>\n            </viewController>\n            <placeholder placeholderIdentifier=\"IBFirstResponder\" id=\"EXPO-PLACEHOLDER-1\" userLabel=\"First Responder\" sceneMemberID=\"firstResponder\"/>\n          </objects>\n        </scene>\n      </scenes>\n      <resources>\n        <image name=\"SplashScreenBackground\" width=\"1\" height=\"1\"/>\n      </resources>\n    </document>`;\n  return await new Parser().parseStringPromise(contents);\n}\n"],"mappings":";;;;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAAsE;AAAA;AAE/D,MAAMA,oBAAoB,GAAG,2BAA2B;AAAC;AAEhE,MAAMC,mBAAmB,GAAG,wBAAwB;;AAEpD;AACA;AACA;AACA;AACA;AACA;AACO,MAAMC,6BAAwE,GAAG,CACtFC,MAAM,EACNC,MAAM,KACH;EACH,OAAO,IAAAC,wBAAO,EAACF,MAAM,EAAE;IACrBG,QAAQ,EAAE,KAAK;IACfC,GAAG,EAAEN,mBAAmB;IACxBG;EACF,CAAC,CAAC;AACJ,CAAC;;AAED;AAAA;AACO,MAAMI,oCAAkD,GAAIL,MAAM,IAAK;EAC5E,OAAOM,yBAAQ,CAACC,qBAAqB,CAACP,MAAM,EAAE;IAC5CG,QAAQ,EAAE,KAAK;IACfK,cAAc,EAAE,IAAI;IACpBC,YAAY,EAAE,KAAK;IACnBC,SAAS,EAAE;MACT;MACA,CAACZ,mBAAmB,GAAGQ,yBAAQ,CAACK,QAAQ,CAAyB;QAC/DC,eAAe,EAAE,IAAI;QACrB,MAAMC,WAAW,CAAC;UAAEC;QAAW,CAAC,EAAE;UAChC;UACA,OAAOC,IAAI,GAACC,IAAI;UACd;UACAF,UAAU,CAACG,mBAAmB;UAC9B;UACAH,UAAU,CAACI,WAAW;UACtB;UACArB,oBAAoB,CACrB;QACH,CAAC;QACD,MAAMsB,IAAI,CAACC,QAAQ,EAAE;UACnB,IAAI;YACF,MAAMC,QAAQ,GAAG,MAAMC,EAAE,GAACC,QAAQ,CAACC,QAAQ,CAACJ,QAAQ,EAAE,MAAM,CAAC;YAC7D,MAAMK,GAAG,GAAG,MAAM,KAAIC,gBAAM,GAAE,CAACC,kBAAkB,CAACN,QAAQ,CAAC;YAC3D,OAAOI,GAAG;UACZ,CAAC,CAAC,MAAM;YACN,OAAOG,gBAAgB,EAAE;UAC3B;QACF,CAAC;QACD,MAAMC,KAAK,CAACT,QAAQ,EAAE;UAAEU,UAAU;UAAEhB,UAAU,EAAE;YAAEiB;UAAW;QAAE,CAAC,EAAE;UAChE,IAAIA,UAAU,EAAE;YACd;UACF;UACA,MAAMT,EAAE,GAACC,QAAQ,CAACS,SAAS,CAACZ,QAAQ,EAAE,IAAAa,4BAAQ,EAACH,UAAU,CAAC,CAAC;QAC7D;MACF,CAAC;IACH;EACF,CAAC,CAAC;AACJ,CAAC;;AAED;AAAA;AACO,eAAeF,gBAAgB,GAAoC;EACxE,MAAMP,QAAQ,GAAI;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;EACd,OAAO,MAAM,KAAIK,gBAAM,GAAE,CAACC,kBAAkB,CAACN,QAAQ,CAAC;AACxD"}