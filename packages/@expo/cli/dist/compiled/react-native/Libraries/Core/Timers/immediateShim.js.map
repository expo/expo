{"version":3,"names":["GUIID","clearedImmediates","Set","setImmediate","callback","_len","arguments","length","args","Array","_key","TypeError","id","has","delete","global","queueMicrotask","apply","undefined","clearImmediate","immediateID","add","immediateShim","module","exports"],"sources":["immediateShim.js"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n * @flow\n */\n\n'use strict';\n\n// Globally Unique Immediate ID.\nlet GUIID = 1;\n\n// A global set of the currently cleared immediates.\nconst clearedImmediates: Set<number> = new Set();\n\n/**\n * Shim the setImmediate API on top of queueMicrotask.\n * @param {function} func Callback to be invoked before the end of the\n * current JavaScript execution loop.\n */\nfunction setImmediate(callback: Function, ...args: any): number {\n  if (arguments.length < 1) {\n    throw new TypeError(\n      'setImmediate must be called with at least one argument (a function to call)',\n    );\n  }\n  if (typeof callback !== 'function') {\n    throw new TypeError(\n      'The first argument to setImmediate must be a function.',\n    );\n  }\n\n  const id = GUIID++;\n  // This is an edgey case in which the sequentially assigned ID has been\n  // \"guessed\" and \"cleared\" ahead of time, so we need to clear it up first.\n  if (clearedImmediates.has(id)) {\n    clearedImmediates.delete(id);\n  }\n\n  // $FlowFixMe[incompatible-call]\n  global.queueMicrotask(() => {\n    if (!clearedImmediates.has(id)) {\n      callback.apply(undefined, args);\n    } else {\n      // Free up the Set entry.\n      clearedImmediates.delete(id);\n    }\n  });\n\n  return id;\n}\n\n/**\n * @param {number} immediateID The ID of the immediate to be clearred.\n */\nfunction clearImmediate(immediateID: number) {\n  clearedImmediates.add(immediateID);\n}\n\nconst immediateShim = {\n  setImmediate: setImmediate,\n  clearImmediate: clearImmediate,\n};\n\nmodule.exports = immediateShim;\n"],"mappings":"AAUA,YAAY;AAGZ,IAAIA,KAAK,GAAG,CAAC;AAGb,IAAMC,iBAA8B,GAAG,IAAIC,GAAG,EAAE;AAOhD,SAASC,YAAYA,CAACC,QAAkB,EAAwB;EAAA,SAAAC,IAAA,GAAAC,SAAA,CAAAC,MAAA,EAAnBC,IAAI,OAAAC,KAAA,CAAAJ,IAAA,OAAAA,IAAA,WAAAK,IAAA,MAAAA,IAAA,GAAAL,IAAA,EAAAK,IAAA;IAAJF,IAAI,CAAAE,IAAA,QAAAJ,SAAA,CAAAI,IAAA;EAAA;EAC/C,IAAIJ,SAAS,CAACC,MAAM,GAAG,CAAC,EAAE;IACxB,MAAM,IAAII,SAAS,CACjB,6EAA6E,CAC9E;EACH;EACA,IAAI,OAAOP,QAAQ,KAAK,UAAU,EAAE;IAClC,MAAM,IAAIO,SAAS,CACjB,wDAAwD,CACzD;EACH;EAEA,IAAMC,EAAE,GAAGZ,KAAK,EAAE;EAGlB,IAAIC,iBAAiB,CAACY,GAAG,CAACD,EAAE,CAAC,EAAE;IAC7BX,iBAAiB,CAACa,MAAM,CAACF,EAAE,CAAC;EAC9B;EAGAG,MAAM,CAACC,cAAc,CAAC,YAAM;IAC1B,IAAI,CAACf,iBAAiB,CAACY,GAAG,CAACD,EAAE,CAAC,EAAE;MAC9BR,QAAQ,CAACa,KAAK,CAACC,SAAS,EAAEV,IAAI,CAAC;IACjC,CAAC,MAAM;MAELP,iBAAiB,CAACa,MAAM,CAACF,EAAE,CAAC;IAC9B;EACF,CAAC,CAAC;EAEF,OAAOA,EAAE;AACX;AAKA,SAASO,cAAcA,CAACC,WAAmB,EAAE;EAC3CnB,iBAAiB,CAACoB,GAAG,CAACD,WAAW,CAAC;AACpC;AAEA,IAAME,aAAa,GAAG;EACpBnB,YAAY,EAAEA,YAAY;EAC1BgB,cAAc,EAAEA;AAClB,CAAC;AAEDI,MAAM,CAACC,OAAO,GAAGF,aAAa"}