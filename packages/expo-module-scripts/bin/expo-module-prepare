#!/usr/bin/env node
'use strict';

import fs from 'node:fs';

import { expoModuleBuild } from './expo-module-build';
import { expoModuleClean } from './expo-module-clean';
import { expoModuleConfigure } from './expo-module-configure';
import { getExtraModuleBuildTypes, setExpoNonInteractive } from './expo-module-utils.js';

function expoModulePrepare() {
  setExpoNonInteractive();

  console.log('Configuring module');
  expoModuleClean([]);
  expoModuleConfigure([]);
  expoModuleBuild([])

  for (const buildType of getExtraModuleBuildTypes()) {
    if (fs.existsSync(buildType)) {
      console.log(`Configuring ${buildType}`);

      expoModuleClean([buildType]);
      expoModuleBuild([buildType])
    }
  }
}

if (import.meta.main) {
  expoModulePrepare();
}