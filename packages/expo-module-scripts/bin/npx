#!/usr/bin/env node
'use strict';

import process from 'node:process';
import child_process from 'node:child_process';

function isExecutableAvailable(name) {
  return child_process.spawnSync(name, ['-v']).status === 0
}

export function npx(args) {
  const userAgent = process.env['npm_config_user_agent']

  if (userAgent === 'yarn' && isExecutableAvailable('yarn')) {
    child_process.spawnSync('yarn', ['exec', '--', 'npx', ...args]);
  } else if (userAgent === 'pnpm' && isExecutableAvailable('pnpm')) {
    child_process.spawnSync('pnpm', ['exec', '--', 'npx', ...args]);
  } else {
    child_process.spawnSync('npx', args);
  }
}

if (import.meta.main) {
  npx(process.argv);
}