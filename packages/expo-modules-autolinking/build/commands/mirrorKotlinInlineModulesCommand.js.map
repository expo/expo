{"version":3,"file":"mirrorKotlinInlineModulesCommand.js","sourceRoot":"","sources":["../../src/commands/mirrorKotlinInlineModulesCommand.ts"],"names":[],"mappings":";;;;;AAUA,4EAgCC;AAzCD,4CAAoB;AACpB,gDAAwB;AAExB,6DAAoE;AACpE,gFAG+C;AAE/C,SAAgB,gCAAgC,CAAC,GAA8B;IAC7E,OAAO,IAAA,iDAA4B,EACjC,GAAG,CAAC,OAAO,CACT,kHAAkH,CACnH,CACF,CAAC,MAAM,CACN,KAAK,EACH,0BAAkC,EAClC,qBAA6B,EAC7B,4BAAoC,EACpC,EAAE;QACF,MAAM,kBAAkB,GAAG,IAAI,CAAC,KAAK,CAAC,4BAA4B,CAAC,CAAC;QACpE,IAAI,CAAC,0BAA0B,IAAI,CAAC,qBAAqB,EAAE,CAAC;YAC1D,MAAM,IAAI,KAAK,CAAC,uEAAuE,CAAC,CAAC;QAC3F,CAAC;QACD,IACE,CAAC,WAAW,CAAC,IAAI,CAAC,0BAA0B,CAAC;YAC7C,CAAC,WAAW,CAAC,IAAI,CAAC,qBAAqB,CAAC,EACxC,CAAC;YACD,MAAM,IAAI,KAAK,CAAC,sDAAsD,CAAC,CAAC;QAC1E,CAAC;QACD,IAAI,CAAC,cAAI,CAAC,UAAU,CAAC,0BAA0B,CAAC,IAAI,CAAC,cAAI,CAAC,UAAU,CAAC,qBAAqB,CAAC,EAAE,CAAC;YAC5F,MAAM,IAAI,KAAK,CACb,wGAAwG,CACzG,CAAC;QACJ,CAAC;QAED,YAAE,CAAC,MAAM,CAAC,0BAA0B,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;QACxE,MAAM,IAAA,kDAA2B,EAAC,0BAA0B,EAAE,kBAAkB,CAAC,CAAC;QAClF,MAAM,IAAA,oDAA6B,EAAC,qBAAqB,EAAE,kBAAkB,CAAC,CAAC;IACjF,CAAC,CACF,CAAC;AACJ,CAAC","sourcesContent":["import commander from 'commander';\nimport fs from 'fs';\nimport path from 'path';\n\nimport { registerAutolinkingArguments } from './autolinkingOptions';\nimport {\n  createSymlinksToKotlinFiles,\n  generateInlineModulesListFile,\n} from '../inlineModules/androidInlineModules';\n\nexport function mirrorKotlinInlineModulesCommand(cli: commander.CommanderStatic) {\n  return registerAutolinkingArguments(\n    cli.command(\n      'mirror-kotlin-inline-modules <kotlinFilesMirrorDirectory> <inlineModulesListPath> <watchedDirectoriesSerialized>'\n    )\n  ).action(\n    async (\n      kotlinFilesMirrorDirectory: string,\n      inlineModulesListPath: string,\n      watchedDirectoriesSerialized: string\n    ) => {\n      const watchedDirectories = JSON.parse(watchedDirectoriesSerialized);\n      if (!kotlinFilesMirrorDirectory || !inlineModulesListPath) {\n        throw new Error('Need to provide kotlinFilesMirrorDirectory and inlineModulesListPath!');\n      }\n      if (\n        !/.android./.test(kotlinFilesMirrorDirectory) ||\n        !/.android./.test(inlineModulesListPath)\n      ) {\n        throw new Error('Generation path is not inside any android directory!');\n      }\n      if (!path.isAbsolute(kotlinFilesMirrorDirectory) || !path.isAbsolute(inlineModulesListPath)) {\n        throw new Error(\n          'Need to provide the absolute path to both the local modules src mirror and generated mirror directory!'\n        );\n      }\n\n      fs.rmSync(kotlinFilesMirrorDirectory, { recursive: true, force: true });\n      await createSymlinksToKotlinFiles(kotlinFilesMirrorDirectory, watchedDirectories);\n      await generateInlineModulesListFile(inlineModulesListPath, watchedDirectories);\n    }\n  );\n}\n"]}